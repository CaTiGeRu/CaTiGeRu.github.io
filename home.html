<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>大柯的blog</title>
  <!-- 引入Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- 引入Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- 引入Markdown解析库 -->
  <script src="https://cdn.jsdelivr.net/npm/marked@4.0.2/marked.min.js"></script>
  <!-- 引入LaTeX渲染库 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"></script>
  
  <!-- 配置Tailwind自定义颜色和字体 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            orange: {
              light: '#FFE0B2',
              DEFAULT: '#FF9800',
              dark: '#E65100',
            },
            neutral: {
              100: '#F5F5F5',
              200: '#EEEEEE',
              300: '#E0E0E0',
              600: '#757575',
              700: '#616161',
              800: '#424242',
              900: '#212121',
            }
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <!-- 自定义工具类 -->
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .text-shadow {
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .card-hover {
        transition: all 0.3s ease;
      }
      .card-hover:hover {
        transform: translateY(-5px);
      }
      .fade-in {
        animation: fadeIn 0.5s ease-in-out;
      }
      .slide-up {
        animation: slideUp 0.5s ease-out;
      }
      .slide-down {
        animation: slideDown 0.3s ease-in-out;
      }
      .scale-in {
        animation: scaleIn 0.3s ease-in-out;
      }
    }
  </style>
  
  <style>
    /* 导入Inter字体 */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    
    /* 平滑滚动 */
    html {
      scroll-behavior: smooth;
    }
    
    /* 渐变背景动画 */
    .gradient-bg {
      background: linear-gradient(135deg, #FF9800 0%, #E65100 100%);
      background-size: 200% 200%;
      animation: gradientShift 8s ease infinite;
    }
    
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    @keyframes slideDown {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    @keyframes scaleIn {
      from { transform: scale(0.95); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    
    /* 编辑器样式 */
    .editor-toolbar button {
      transition: all 0.2s ease;
    }
    
    .editor-toolbar button:hover {
      background-color: #FFE0B2;
      transform: scale(1.1);
    }
    
    .editor-content:focus {
      outline: none;
      box-shadow: 0 0 0 2px rgba(255, 152, 0, 0.3);
    }
    
    /* Markdown编辑器样式 */
    .markdown-editor {
      font-family: 'Consolas', 'Monaco', monospace;
      line-height: 1.6;
    }
    
    /* Markdown预览样式 */
    .markdown-preview h1 { font-size: 2em; margin: 0.67em 0; }
    .markdown-preview h2 { font-size: 1.5em; margin: 0.83em 0; }
    .markdown-preview h3 { font-size: 1.17em; margin: 1em 0; }
    .markdown-preview h4, .markdown-preview h5, .markdown-preview h6 { margin: 1.33em 0; }
    .markdown-preview p { margin: 1em 0; }
    .markdown-preview ul, .markdown-preview ol { margin: 1em 0 1em 2em; }
    .markdown-preview blockquote { border-left: 4px solid #FF9800; padding-left: 1em; margin: 1em 0; color: #616161; }
    .markdown-preview pre { background: #f5f5f5; padding: 1em; border-radius: 4px; overflow-x: auto; }
    .markdown-preview code { background: #f5f5f5; padding: 0.2em 0.4em; border-radius: 4px; }
    .markdown-preview img { max-width: 100%; height: auto; margin: 1em 0; }
    .markdown-preview a { color: #FF9800; text-decoration: none; }
    .markdown-preview a:hover { text-decoration: underline; }
    .markdown-preview table { border-collapse: collapse; margin: 1em 0; width: 100%; }
    .markdown-preview th, .markdown-preview td { border: 1px solid #ddd; padding: 0.5em; text-align: left; }
    .markdown-preview th { background-color: #f5f5f5; }
    
    /* 管理表格样式 */
    .manage-table tr {
      transition: background-color 0.2s ease;
    }
    
    .manage-table tr:hover {
      background-color: rgba(255, 224, 178, 0.3);
    }
    
    /* 排序按钮样式 */
    .sort-btn.active {
      background-color: #FF9800;
      color: white;
    }
    
    .sort-btn.active .sort-icon {
      transform: rotate(180deg);
    }
    
    /* 编辑模式切换按钮 */
    .edit-mode-tabs button.active {
      background-color: #FF9800;
      color: white;
    }
  </style>
</head>

<body class="bg-neutral-100 font-sans text-neutral-800">
  <!-- 导航栏 -->
  <header class="sticky top-0 z-50 bg-white/90 backdrop-blur-sm shadow-sm transition-all duration-300">
    <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
      <a href="#" class="text-xl font-bold text-orange-dark flex items-center gap-2">
        <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
        <span>大柯的blog</span>
      </a>
      
      <!-- 桌面导航 -->
      <div class="hidden md:flex items-center gap-6">
        <a href="#" class="font-medium hover:text-orange transition-colors" data-page="home">首页</a>
        <a href="#" class="font-medium hover:text-orange transition-colors" data-page="categories">分类</a>
        <a href="#" class="font-medium hover:text-orange transition-colors" data-page="manage">管理文章</a>
        <a href="#" class="font-medium hover:text-orange transition-colors" data-page="about">关于</a>
        <a href="#" class="font-medium hover:text-orange transition-colors" data-page="write">
          <i class="fa fa-plus-circle mr-1" aria-hidden="true"></i> 写文章
        </a>
        <button class="bg-orange hover:bg-orange-dark text-white px-4 py-2 rounded-full transition-colors">
          <i class="fa fa-search mr-1" aria-hidden="true"></i> 搜索
        </button>
      </div>
      
      <!-- 移动端菜单按钮 -->
      <button class="md:hidden text-neutral-800 hover:text-orange transition-colors" id="menuBtn">
        <i class="fa fa-bars text-xl" aria-hidden="true"></i>
      </button>
    </nav>
    
    <!-- 移动端导航菜单 -->
    <div class="md:hidden hidden bg-white border-t" id="mobileMenu">
      <div class="container mx-auto px-4 py-3 flex flex-col gap-3">
        <a href="#" class="py-2 font-medium hover:text-orange transition-colors" data-page="home">首页</a>
        <a href="#" class="py-2 font-medium hover:text-orange transition-colors" data-page="categories">分类</a>
        <a href="#" class="py-2 font-medium hover:text-orange transition-colors" data-page="manage">管理文章</a>
        <a href="#" class="py-2 font-medium hover:text-orange transition-colors" data-page="about">关于</a>
        <a href="#" class="py-2 font-medium hover:text-orange transition-colors" data-page="write">
          <i class="fa fa-plus-circle mr-1" aria-hidden="true"></i> 写文章
        </a>
        <div class="relative">
          <input type="text" placeholder="搜索文章..." class="w-full px-4 py-2 rounded-full border border-neutral-300 focus:outline-none focus:ring-2 focus:ring-orange/50">
          <button class="absolute right-3 top-1/2 transform -translate-y-1/2 text-neutral-600">
            <i class="fa fa-search" aria-hidden="true"></i>
          </button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <!-- 页面容器 - 所有页面内容都在这里切换显示 -->
    <div id="pageContainer">
      <!-- 首页内容 -->
      <div id="homePage" class="page-content">
        <!-- 博客标题区域 -->
        <section class="gradient-bg text-white py-16 md:py-24">
          <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl md:text-6xl font-bold mb-4 text-shadow">大柯的blog</h1>
            <p class="text-lg md:text-xl max-w-2xl mx-auto opacity-90">支持Markdown和LaTeX的个人博客空间</p>
          </div>
        </section>
        
        <!-- 文章列表区域 -->
        <section class="container mx-auto px-4 py-12">
          <div class="flex justify-between items-center mb-8 flex-wrap gap-4">
            <h2 class="text-2xl font-bold text-neutral-800">最新文章</h2>
            <div class="flex gap-2">
              <button class="px-3 py-1 rounded-full bg-orange text-white text-sm category-filter" data-category="all">全部</button>
              <button class="px-3 py-1 rounded-full bg-white border border-neutral-300 hover:border-orange hover:text-orange text-sm transition-colors category-filter" data-category="技术">技术</button>
              <button class="px-3 py-1 rounded-full bg-white border border-neutral-300 hover:border-orange hover:text-orange text-sm transition-colors category-filter" data-category="生活">生活</button>
              <button class="px-3 py-1 rounded-full bg-white border border-neutral-300 hover:border-orange hover:text-orange text-sm transition-colors category-filter" data-category="思考">思考</button>
            </div>
          </div>
          
          <!-- 文章网格 -->
          <div id="articlesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <!-- 文章将通过JavaScript动态加载 -->
            <div id="noArticles" class="col-span-full text-center py-16 hidden">
              <i class="fa fa-file-text-o text-6xl text-neutral-300 mb-4" aria-hidden="true"></i>
              <p class="text-neutral-600 text-lg">还没有发布任何文章</p>
              <a href="#" class="inline-block mt-4 text-orange hover:underline font-medium" data-page="write">
                <i class="fa fa-pencil mr-1" aria-hidden="true"></i> 写第一篇文章
              </a>
            </div>
          </div>
          
          <!-- 加载更多按钮 -->
          <div class="mt-12 text-center">
            <button id="loadMoreBtn" class="px-6 py-3 bg-white border-2 border-orange text-orange rounded-full font-medium hover:bg-orange hover:text-white transition-colors duration-300 hidden">
              加载更多文章 <i class="fa fa-refresh ml-2" aria-hidden="true"></i>
            </button>
          </div>
        </section>
        
        <!-- 订阅区域 -->
        <section class="bg-orange-light py-12 mt-12">
          <div class="container mx-auto px-4 text-center">
            <h2 class="text-2xl font-bold mb-3">订阅我的博客更新</h2>
            <p class="text-neutral-700 mb-6 max-w-md mx-auto">第一时间获取最新文章和独家内容，不会发送垃圾邮件</p>
            <div class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto">
              <input type="email" placeholder="输入你的邮箱地址" class="flex-1 px-4 py-3 rounded-full focus:outline-none focus:ring-2 focus:ring-orange">
              <button class="bg-orange hover:bg-orange-dark text-white px-6 py-3 rounded-full font-medium transition-colors">
                订阅 <i class="fa fa-paper-plane ml-1" aria-hidden="true"></i>
              </button>
            </div>
          </div>
        </section>
      </div>
      
      <!-- 文章阅读页面 -->
      <div id="articlePage" class="page-content hidden py-12">
        <div class="container mx-auto px-4 max-w-4xl">
          <!-- 返回按钮 -->
          <div class="mb-8">
            <a href="#" class="inline-flex items-center text-neutral-600 hover:text-orange transition-colors back-to-list" data-page="home">
              <i class="fa fa-arrow-left mr-2" aria-hidden="true"></i> 返回文章列表
            </a>
          </div>
          
          <!-- 文章内容 -->
          <article class="bg-white rounded-xl shadow-md overflow-hidden">
            <!-- 文章封面 -->
            <div class="w-full h-64 md:h-80 overflow-hidden">
              <img id="articleReadCover" src="" alt="文章封面" class="w-full h-full object-cover">
            </div>
            
            <!-- 文章标题和元数据 -->
            <div class="p-6 md:p-8">
              <div class="flex items-center gap-2 text-sm text-neutral-600 mb-4 flex-wrap">
                <span id="articleReadCategory" class="bg-orange-light text-orange px-2 py-1 rounded-full"></span>
                <span id="articleReadDate"><i class="fa fa-calendar-o mr-1" aria-hidden="true"></i></span>
                <span id="articleReadTime"><i class="fa fa-clock-o mr-1" aria-hidden="true"></i></span>
              </div>
              
              <h1 id="articleReadTitle" class="text-3xl md:text-4xl font-bold mb-6"></h1>
              
              <div id="articleReadContent" class="markdown-preview text-lg text-neutral-800"></div>
              
              <!-- 文章操作按钮 -->
              <div class="mt-12 pt-6 border-t border-neutral-200 flex flex-wrap gap-4 justify-between items-center">
                <div class="flex gap-4">
                  <button class="text-neutral-600 hover:text-orange transition-colors flex items-center gap-1 edit-article" data-id="">
                    <i class="fa fa-pencil" aria-hidden="true"></i> 编辑
                  </button>
                  <button class="text-neutral-600 hover:text-red-500 transition-colors flex items-center gap-1 delete-article" data-id="">
                    <i class="fa fa-trash" aria-hidden="true"></i> 删除
                  </button>
                </div>
                
                <div class="flex gap-4">
                  <button class="text-neutral-600 hover:text-orange transition-colors flex items-center gap-1">
                    <i class="fa fa-share-alt" aria-hidden="true"></i> 分享
                  </button>
                  <button class="text-neutral-600 hover:text-orange transition-colors flex items-center gap-1">
                    <i class="fa fa-heart-o" aria-hidden="true"></i> 喜欢
                  </button>
                </div>
              </div>
            </div>
          </article>
          
          <!-- 上下篇导航 -->
          <div class="mt-10 grid grid-cols-1 md:grid-cols-2 gap-6">
            <div id="prevArticleContainer" class="bg-white rounded-xl shadow-md p-4 md:p-6 hidden">
              <p class="text-sm text-neutral-600 mb-2">上一篇</p>
              <a href="#" class="text-lg font-medium hover:text-orange transition-colors prev-article-link" data-id="">
                <i class="fa fa-angle-left mr-1" aria-hidden="true"></i>
                <span id="prevArticleTitle"></span>
              </a>
            </div>
            
            <div id="nextArticleContainer" class="bg-white rounded-xl shadow-md p-4 md:p-6 hidden md:text-right">
              <p class="text-sm text-neutral-600 mb-2">下一篇</p>
              <a href="#" class="text-lg font-medium hover:text-orange transition-colors next-article-link" data-id="">
                <span id="nextArticleTitle"></span>
                <i class="fa fa-angle-right ml-1" aria-hidden="true"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 写文章页面 -->
      <div id="writePage" class="page-content hidden py-12">
        <div class="container mx-auto px-4 max-w-4xl">
          <div class="flex items-center mb-8">
            <a href="#" class="text-neutral-600 hover:text-orange mr-4 transition-colors" data-page="home">
              <i class="fa fa-arrow-left" aria-hidden="true"></i> 返回首页
            </a>
            <h2 class="text-2xl font-bold">写文章</h2>
          </div>
          
          <form id="articleForm" class="bg-white rounded-xl shadow-md p-6 md:p-8">
            <input type="hidden" id="articleId"> <!-- 用于编辑现有文章 -->
            
            <div class="mb-6">
              <label for="articleTitle" class="block text-neutral-700 font-medium mb-2">标题</label>
              <input type="text" id="articleTitle" name="title" 
                     class="w-full px-4 py-3 rounded-lg border border-neutral-300 focus:outline-none focus:ring-2 focus:ring-orange focus:border-transparent"
                     placeholder="输入文章标题..." required>
            </div>
            
            <div class="mb-6">
              <label for="articleCategory" class="block text-neutral-700 font-medium mb-2">分类</label>
              <select id="articleCategory" name="category" 
                      class="w-full px-4 py-3 rounded-lg border border-neutral-300 focus:outline-none focus:ring-2 focus:ring-orange focus:border-transparent"
                      required>
                <option value="">选择分类</option>
                <option value="技术">技术</option>
                <option value="生活">生活</option>
                <option value="思考">思考</option>
                <option value="旅行">旅行</option>
                <option value="阅读">阅读</option>
              </select>
            </div>
            
            <div class="mb-6">
              <label for="articleCover" class="block text-neutral-700 font-medium mb-2">封面图URL</label>
              <input type="url" id="articleCover" name="cover" 
                     class="w-full px-4 py-3 rounded-lg border border-neutral-300 focus:outline-none focus:ring-2 focus:ring-orange focus:border-transparent"
                     placeholder="输入图片URL...">
              <p class="text-sm text-neutral-500 mt-1">建议尺寸：600x400px，支持网络图片URL</p>
            </div>
            
            <!-- 编辑模式切换 -->
            <div class="mb-4">
              <div class="edit-mode-tabs flex border-b border-neutral-300">
                <button type="button" id="markdownModeBtn" class="px-4 py-2 font-medium active">
                  <i class="fa fa-markdown mr-1" aria-hidden="true"></i> Markdown编辑
                </button>
                <button type="button" id="previewModeBtn" class="px-4 py-2 font-medium text-neutral-600">
                  <i class="fa fa-eye mr-1" aria-hidden="true"></i> 预览
                </button>
                <button type="button" id="splitModeBtn" class="px-4 py-2 font-medium text-neutral-600">
                  <i class="fa fa-columns mr-1" aria-hidden="true"></i> 分屏编辑
                </button>
              </div>
            </div>
            
            <!-- 编辑器工具栏 - Markdown专用 -->
            <div class="editor-toolbar flex flex-wrap gap-2 p-3 bg-neutral-100 rounded-t-lg border border-b-0 border-neutral-300">
              <button type="button" data-action="heading1" title="标题1">
                <i class="fa fa-header" aria-hidden="true"></i> <sub>1</sub>
              </button>
              <button type="button" data-action="heading2" title="标题2">
                <i class="fa fa-header" aria-hidden="true"></i> <sub>2</sub>
              </button>
              <button type="button" data-action="heading3" title="标题3">
                <i class="fa fa-header" aria-hidden="true"></i> <sub>3</sub>
              </button>
              <span class="h-6 border-r border-neutral-300"></span>
              <button type="button" data-action="bold" title="加粗 (**粗体**)">
                <i class="fa fa-bold" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="italic" title="斜体 (*斜体*)">
                <i class="fa fa-italic" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="strikethrough" title="删除线 (~~删除线~~)">
                <i class="fa fa-strikethrough" aria-hidden="true"></i>
              </button>
              <span class="h-6 border-r border-neutral-300"></span>
              <button type="button" data-action="link" title="链接 ([文本](链接))">
                <i class="fa fa-link" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="image" title="图片 (![描述](链接))">
                <i class="fa fa-image" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="code" title="代码 (`代码`)">
                <i class="fa fa-code" aria-hidden="true"></i>
              </button>
              <span class="h-6 border-r border-neutral-300"></span>
              <button type="button" data-action="quote" title="引用 (> 引用)">
                <i class="fa fa-quote-right" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="unordered-list" title="无序列表 (- 列表项)">
                <i class="fa fa-list-ul" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="ordered-list" title="有序列表 (1. 列表项)">
                <i class="fa fa-list-ol" aria-hidden="true"></i>
              </button>
              <span class="h-6 border-r border-neutral-300"></span>
              <button type="button" data-action="latex" title="LaTeX公式 ($公式$ 或 $$块公式$$)">
                <i class="fa fa-superscript" aria-hidden="true"></i> TeX
              </button>
              <button type="button" data-action="table" title="表格">
                <i class="fa fa-table" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="hr" title="分割线 (---)">
                <i class="fa fa-minus" aria-hidden="true"></i>
              </button>
            </div>
            
            <!-- 编辑器容器 -->
            <div class="border border-neutral-300 rounded-b-lg overflow-hidden">
              <!-- Markdown编辑区 -->
              <div id="markdownEditor" class="w-full min-h-[400px] p-4 bg-white">
                <textarea id="articleContent" class="markdown-editor w-full h-full min-h-[400px] p-2 focus:outline-none resize-none" 
                          placeholder="使用Markdown编写文章内容...
支持的格式:
# 标题
**粗体** *斜体*
- 列表项
[链接](url)
![图片](url)
`代码`
> 引用
LaTeX公式: $E=mc^2$ 或 $$\sum_{i=1}^n i$$
"></textarea>
              </div>
              
              <!-- 预览区 -->
              <div id="previewArea" class="w-full min-h-[400px] p-4 bg-neutral-50 hidden markdown-preview"></div>
              
              <!-- 分屏编辑区 -->
              <div id="splitEditor" class="hidden">
                <div class="flex h-[400px]">
                  <div class="w-1/2 border-r border-neutral-300">
                    <textarea id="splitArticleContent" class="markdown-editor w-full h-full p-4 focus:outline-none resize-none" 
                              placeholder="使用Markdown编写文章内容..."></textarea>
                  </div>
                  <div id="splitPreviewArea" class="w-1/2 p-4 overflow-y-auto markdown-preview"></div>
                </div>
              </div>
            </div>
            
            <div class="flex justify-end gap-4 mt-6">
              <button type="button" id="cancelEditBtn" class="px-6 py-3 bg-white border border-neutral-300 text-neutral-700 rounded-full font-medium hover:bg-neutral-100 transition-colors">
                取消
              </button>
              <button type="button" id="helpBtn" class="px-6 py-3 bg-white border border-neutral-300 text-neutral-700 rounded-full font-medium hover:bg-neutral-100 transition-colors">
                <i class="fa fa-question-circle mr-1" aria-hidden="true"></i> 格式帮助
              </button>
              <button type="submit" class="px-6 py-3 bg-orange hover:bg-orange-dark text-white rounded-full font-medium transition-colors">
                <span id="submitBtnText">发布文章</span> <i class="fa fa-paper-plane ml-1" aria-hidden="true"></i>
              </button>
            </div>
          </form>
        </div>
      </div>
      
      <!-- 格式帮助模态框 -->
      <div id="helpModal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center hidden fade-in">
        <div class="bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto m-4">
          <div class="p-6 border-b border-neutral-200 flex justify-between items-center">
            <h3 class="text-xl font-bold">Markdown格式帮助</h3>
            <button id="closeHelpBtn" class="text-neutral-500 hover:text-neutral-800 transition-colors">
              <i class="fa fa-times text-xl" aria-hidden="true"></i>
            </button>
          </div>
          <div class="p-6">
            <div class="mb-6">
              <h4 class="text-lg font-semibold mb-3">标题</h4>
              <div class="bg-neutral-50 p-3 rounded-md mb-2">
                <pre># 一级标题
## 二级标题
### 三级标题
#### 四级标题</pre>
              </div>
              <div class="markdown-preview">
                <h3>示例</h3>
                <h1>一级标题</h1>
                <h2>二级标题</h2>
                <h3>三级标题</h3>
              </div>
            </div>
            
            <div class="mb-6">
              <h4 class="text-lg font-semibold mb-3">文本格式</h4>
              <div class="bg-neutral-50 p-3 rounded-md mb-2">
                <pre>**粗体文本**
*斜体文本*
***粗斜体文本***
~~删除线~~</pre>
              </div>
              <div class="markdown-preview">
                <p>**粗体文本** → <strong>粗体文本</strong></p>
                <p>*斜体文本* → <em>斜体文本</em></p>
                <p>***粗斜体文本*** → <strong><em>粗斜体文本</em></strong></p>
                <p>~~删除线~~ → <s>删除线</s></p>
              </div>
            </div>
            
            <div class="mb-6">
              <h4 class="text-lg font-semibold mb-3">列表</h4>
              <div class="bg-neutral-50 p-3 rounded-md mb-2">
                <pre>无序列表:
- 列表项1
- 列表项2
  - 子列表项
  
有序列表:
1. 第一项
2. 第二项
   1. 子项1
   2. 子项2</pre>
              </div>
              <div class="markdown-preview">
                <h5>无序列表示例</h5>
                <ul>
                  <li>列表项1</li>
                  <li>列表项2
                    <ul>
                      <li>子列表项</li>
                    </ul>
                  </li>
                </ul>
                
                <h5>有序列表示例</h5>
                <ol>
                  <li>第一项</li>
                  <li>第二项
                    <ol>
                      <li>子项1</li>
                      <li>子项2</li>
                    </ol>
                  </li>
                </ol>
              </div>
            </div>
            
            <div class="mb-6">
              <h4 class="text-lg font-semibold mb-3">链接和图片</h4>
              <div class="bg-neutral-50 p-3 rounded-md mb-2">
                <pre>链接:
[链接文本](https://example.com "可选标题")

图片:
![图片描述](https://picsum.photos/200/100)</pre>
              </div>
              <div class="markdown-preview">
                <p>链接示例: <a href="#" target="_blank">链接文本</a></p>
                <p>图片示例: <img src="https://picsum.photos/200/100" alt="图片描述"></p>
              </div>
            </div>
            
            <div class="mb-6">
              <h4 class="text-lg font-semibold mb-3">代码</h4>
              <div class="bg-neutral-50 p-3 rounded-md mb-2">
                <pre>行内代码: `const x = 10;`

代码块:function hello() {
  console.log("Hello World");
}              </div>
              <div class="markdown-preview">
                <p>行内代码示例: <code>const x = 10;</code></p>
                <p>代码块示例:</p>
                <pre><code class="language-javascript">function hello() {
  console.log("Hello World");
}</code></pre>
              </div>
            </div>
            
            <div class="mb-6">
              <h4 class="text-lg font-semibold mb-3">LaTeX公式</h4>
              <div class="bg-neutral-50 p-3 rounded-md mb-2">
                <pre>内联公式: $E = mc^2$

块级公式:
$$
\sum_{i=1}^n i = \frac{n(n+1)}{2}
$$</pre>
              </div>
              <div class="markdown-preview">
                <p>内联公式示例: $E = mc^2$</p>
                <p>块级公式示例:</p>
                <p>$$\sum_{i=1}^n i = \frac{n(n+1)}{2}$$</p>
              </div>
              <script>renderMathInElement(document.querySelector('#helpModal .markdown-preview'), {delimiters: [{left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}]});</script>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 文章管理页面 -->
      <div id="managePage" class="page-content hidden py-12">
        <div class="container mx-auto px-4 max-w-5xl">
          <div class="flex items-center mb-8">
            <a href="#" class="text-neutral-600 hover:text-orange mr-4 transition-colors" data-page="home">
              <i class="fa fa-arrow-left" aria-hidden="true"></i> 返回首页
            </a>
            <h2 class="text-2xl font-bold">管理文章</h2>
          </div>
          
          <div class="bg-white rounded-xl shadow-md p-6 md:p-8">
            <!-- 管理工具栏 -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6 pb-4 border-b border-neutral-200">
              <div class="flex items-center gap-2">
                <button id="addNewArticleBtn" class="px-4 py-2 bg-orange hover:bg-orange-dark text-white rounded-lg font-medium transition-colors flex items-center gap-1">
                  <i class="fa fa-plus" aria-hidden="true"></i> 新建文章
                </button>
                <button id="batchDeleteBtn" class="px-4 py-2 bg-white border border-red-200 text-red-500 hover:bg-red-50 rounded-lg font-medium transition-colors flex items-center gap-1 hidden">
                  <i class="fa fa-trash" aria-hidden="true"></i> 批量删除
                </button>
              </div>
              
              <div class="flex flex-wrap gap-3 w-full md:w-auto">
                <div class="relative">
                  <input type="text" id="manageSearchInput" placeholder="搜索文章..." class="w-full md:w-64 px-4 py-2 pl-10 rounded-lg border border-neutral-300 focus:outline-none focus:ring-2 focus:ring-orange focus:border-transparent">
                  <i class="fa fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400" aria-hidden="true"></i>
                </div>
                
                <div class="flex items-center gap-2">
                  <label class="text-neutral-600 whitespace-nowrap">排序：</label>
                  <div class="flex flex-wrap gap-1">
                    <button class="sort-btn px-3 py-1 rounded bg-white border border-neutral-300 hover:border-orange text-sm transition-colors" data-sort="newest">
                      最新 <i class="fa fa-chevron-down sort-icon ml-1 text-xs" aria-hidden="true"></i>
                    </button>
                    <button class="sort-btn px-3 py-1 rounded bg-white border border-neutral-300 hover:border-orange text-sm transition-colors" data-sort="oldest">
                      最早 <i class="fa fa-chevron-down sort-icon ml-1 text-xs" aria-hidden="true"></i>
                    </button>
                    <button class="sort-btn px-3 py-1 rounded bg-white border border-neutral-300 hover:border-orange text-sm transition-colors" data-sort="title-asc">
                      标题A-Z <i class="fa fa-chevron-down sort-icon ml-1 text-xs" aria-hidden="true"></i>
                    </button>
                    <button class="sort-btn px-3 py-1 rounded bg-white border border-neutral-300 hover:border-orange text-sm transition-colors" data-sort="title-desc">
                      标题Z-A <i class="fa fa-chevron-down sort-icon ml-1 text-xs" aria-hidden="true"></i>
                    </button>
                    <button class="sort-btn px-3 py-1 rounded bg-white border border-neutral-300 hover:border-orange text-sm transition-colors" data-sort="category">
                      分类 <i class="fa fa-chevron-down sort-icon ml-1 text-xs" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- 文章管理表格 -->
            <div class="overflow-x-auto">
              <table class="w-full manage-table">
                <thead>
                  <tr class="border-b-2 border-neutral-200">
                    <th class="text-left py-3 px-4 w-12">
                      <input type="checkbox" id="selectAllCheckbox" class="rounded text-orange focus:ring-orange">
                    </th>
                    <th class="text-left py-3 px-4">标题</th>
                    <th class="text-left py-3 px-4 hidden md:table-cell">分类</th>
                    <th class="text-left py-3 px-4 hidden sm:table-cell">发布日期</th>
                    <th class="text-left py-3 px-4 hidden lg:table-cell">阅读时间</th>
                    <th class="text-right py-3 px-4">操作</th>
                  </tr>
                </thead>
                <tbody id="manageArticlesTable">
                  <!-- 管理文章将通过JavaScript动态加载 -->
                  <tr id="noArticlesManage" class="text-center">
                    <td colspan="6" class="py-12 text-neutral-500">
                      <i class="fa fa-file-text-o text-4xl mb-2" aria-hidden="true"></i>
                      <p>没有文章可管理</p>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <!-- 分页 -->
            <div class="flex justify-between items-center mt-6 pt-4 border-t border-neutral-200">
              <div class="text-neutral-600 text-sm">
                显示 <span id="showingCount">0</span> 篇文章，共 <span id="totalCount">0</span> 篇
              </div>
              <div class="flex gap-2">
                <button id="prevPageBtn" class="px-3 py-1 rounded border border-neutral-300 text-neutral-600 hover:border-orange hover:text-orange disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                  <i class="fa fa-chevron-left" aria-hidden="true"></i> 上一页
                </button>
                <button id="nextPageBtn" class="px-3 py-1 rounded border border-neutral-300 text-neutral-600 hover:border-orange hover:text-orange disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                  下一页 <i class="fa fa-chevron-right" aria-hidden="true"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 文章预览模态框 -->
      <div id="previewModal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center hidden fade-in">
        <div class="bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto m-4">
          <div class="p-6 border-b border-neutral-200 flex justify-between items-center">
            <h3 class="text-xl font-bold">文章预览</h3>
            <button id="closePreviewBtn" class="text-neutral-500 hover:text-neutral-800 transition-colors">
              <i class="fa fa-times text-xl" aria-hidden="true"></i>
            </button>
          </div>
          <div id="previewContent" class="p-6 markdown-preview">
            <!-- 预览内容将通过JavaScript动态生成 -->
          </div>
        </div>
      </div>
      
      <!-- 删除确认模态框 -->
      <div id="deleteConfirmModal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center hidden fade-in">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full m-4 scale-in">
          <div class="p-6 border-b border-neutral-200">
            <h3 class="text-xl font-bold text-red-500">确认删除</h3>
          </div>
          <div class="p-6">
            <p class="mb-6">你确定要删除这篇文章吗？此操作无法撤销。</p>
            <div class="flex justify-end gap-3">
              <button id="cancelDeleteBtn" class="px-4 py-2 border border-neutral-300 rounded-lg text-neutral-700 hover:bg-neutral-100 transition-colors">
                取消
              </button>
              <button id="confirmDeleteBtn" class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors">
                确认删除
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 分类页面 -->
      <div id="categoriesPage" class="page-content hidden py-12">
        <div class="container mx-auto px-4">
          <div class="flex items-center mb-8">
            <a href="#" class="text-neutral-600 hover:text-orange mr-4 transition-colors" data-page="home">
              <i class="fa fa-arrow-left" aria-hidden="true"></i> 返回首页
            </a>
            <h2 class="text-2xl font-bold">文章分类</h2>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-white rounded-xl shadow-md p-6 text-center card-hover">
              <div class="w-16 h-16 bg-orange-light rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa fa-code text-2xl text-orange" aria-hidden="true"></i>
              </div>
              <h3 class="text-xl font-bold mb-2">技术</h3>
              <p class="text-neutral-600 mb-4">关于编程、开发工具和技术趋势的文章</p>
              <p class="text-orange font-medium"><span id="techCount">0</span> 篇文章</p>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-6 text-center card-hover">
              <div class="w-16 h-16 bg-orange-light rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa fa-coffee text-2xl text-orange" aria-hidden="true"></i>
              </div>
              <h3 class="text-xl font-bold mb-2">生活</h3>
              <p class="text-neutral-600 mb-4">记录日常生活、习惯养成和生活感悟</p>
              <p class="text-orange font-medium"><span id="lifeCount">0</span> 篇文章</p>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-6 text-center card-hover">
              <div class="w-16 h-16 bg-orange-light rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa fa-lightbulb-o text-2xl text-orange" aria-hidden="true"></i>
              </div>
              <h3 class="text-xl font-bold mb-2">思考</h3>
              <p class="text-neutral-600 mb-4">关于职业发展、学习方法的思考与总结</p>
              <p class="text-orange font-medium"><span id="thoughtCount">0</span> 篇文章</p>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 关于页面 -->
      <div id="aboutPage" class="page-content hidden py-12">
        <div class="container mx-auto px-4 max-w-3xl">
          <div class="flex items-center mb-8">
            <a href="#" class="text-neutral-600 hover:text-orange mr-4 transition-colors" data-page="home">
              <i class="fa fa-arrow-left" aria-hidden="true"></i> 返回首页
            </a>
            <h2 class="text-2xl font-bold">关于我</h2>
          </div>
          
          <div class="bg-white rounded-xl shadow-md p-8">
            <div class="flex flex-col md:flex-row gap-8">
              <div class="md:w-1/3">
                <div class="rounded-full overflow-hidden w-40 h-40 mx-auto md:mx-0 border-4 border-orange-light">
                  <img src="https://picsum.photos/400/400?random=10" alt="博主头像" class="w-full h-full object-cover">
                </div>
              </div>
              <div class="md:w-2/3">
                <h3 class="text-2xl font-bold mb-4">大柯</h3>
                <p class="text-neutral-600 mb-4">
                  热爱技术与生活的创作者，致力于分享有价值的思考和经验。
                </p>
                <p class="text-neutral-600 mb-4">
                  这个博客支持Markdown编辑和LaTeX数学公式，特别适合分享技术文章和学术内容。希望通过文字与更多志同道合的朋友交流。
                </p>
                <div class="flex gap-4 mt-6">
                  <a href="#" class="text-neutral-600 hover:text-orange transition-colors text-xl">
                    <i class="fa fa-github" aria-hidden="true"></i>
                  </a>
                  <a href="#" class="text-neutral-600 hover:text-orange transition-colors text-xl">
                    <i class="fa fa-twitter" aria-hidden="true"></i>
                  </a>
                  <a href="#" class="text-neutral-600 hover:text-orange transition-colors text-xl">
                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- 页脚 -->
  <footer class="bg-neutral-800 text-white py-12">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
        <div>
          <h3 class="text-xl font-bold mb-4 text-orange">大柯的blog</h3>
          <p class="text-neutral-400 mb-4">支持Markdown和LaTeX的个人博客，分享技术、生活与思考，记录成长的点滴。</p>
          <div class="flex gap-4">
            <a href="#" class="text-neutral-400 hover:text-orange transition-colors text-lg">
              <i class="fa fa-github" aria-hidden="true"></i>
            </a>
            <a href="#" class="text-neutral-400 hover:text-orange transition-colors text-lg">
              <i class="fa fa-twitter" aria-hidden="true"></i>
            </a>
            <a href="#" class="text-neutral-400 hover:text-orange transition-colors text-lg">
              <i class="fa fa-linkedin" aria-hidden="true"></i>
            </a>
            <a href="#" class="text-neutral-400 hover:text-orange transition-colors text-lg">
              <i class="fa fa-instagram" aria-hidden="true"></i>
            </a>
          </div>
        </div>
        
        <div>
          <h4 class="text-lg font-semibold mb-4">快速链接</h4>
          <ul class="space-y-2">
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors" data-page="home">首页</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors" data-page="categories">所有文章</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors" data-page="manage">管理文章</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors" data-page="about">关于我</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors" data-page="write">写文章</a></li>
          </ul>
        </div>
        
        <div>
          <h4 class="text-lg font-semibold mb-4">分类</h4>
          <ul class="space-y-2">
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors">技术</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors">生活</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors">思考</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors">旅行</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors">阅读</a></li>
          </ul>
        </div>
      </div>
      
      <div class="border-t border-neutral-700 pt-8 text-center text-neutral-500 text-sm">
        <p>&copy; 2023 大柯的blog. 保留所有权利。</p>
      </div>
    </div>
  </footer>

  <!-- 返回顶部按钮 -->
  <button id="backToTop" class="fixed bottom-6 right-6 bg-orange hover:bg-orange-dark text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg transition-all duration-300 opacity-0 invisible">
    <i class="fa fa-arrow-up" aria-hidden="true"></i>
  </button>

  <!-- 通知提示 -->
  <div id="notification" class="fixed top-6 right-6 bg-white shadow-lg rounded-lg p-4 max-w-xs transform translate-x-[calc(100%+20px)] transition-transform duration-300 z-50 flex items-start gap-3">
    <div id="notificationIcon" class="text-green-500 mt-0.5">
      <i class="fa fa-check-circle text-xl" aria-hidden="true"></i>
    </div>
    <div>
      <h4 id="notificationTitle" class="font-semibold text-neutral-800">成功</h4>
      <p id="notificationMessage" class="text-neutral-600 text-sm">操作已完成</p>
    </div>
    <button id="closeNotification" class="text-neutral-400 hover:text-neutral-600 ml-auto">
      <i class="fa fa-times" aria-hidden="true"></i>
    </button>
  </div>

  <!-- JavaScript -->
  <script>
    // 全局变量
    let currentSort = 'newest';
    let currentPage = 1;
    const articlesPerPage = 10;
    let selectedArticleIds = [];
    let articleToDelete = null;
    let allArticles = []; // 存储所有文章用于导航
    let currentArticleId = null; // 跟踪当前阅读的文章ID
    let currentEditMode = 'markdown'; // markdown, preview, split
    
    // 页面加载完成后执行
    document.addEventListener('DOMContentLoaded', function() {
      // 从JSON文件加载文章
      loadArticlesFromJson();
      // 初始化事件监听
      initEventListeners();
      // 设置默认排序
      document.querySelector(`.sort-btn[data-sort="${currentSort}"]`).classList.add('active');
      // 初始化LaTeX渲染
      renderMathInElement(document.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false}
        ]
      });
    });
    
    // 从JSON文件加载文章
    function loadArticlesFromJson() {
      // 显示加载状态
      showNotification('加载中', '正在加载文章...', false);
      
      fetch('https://catigeru.github.io/passage.json', {
        headers: {
          'Accept': 'application/json',
          'Accept-Charset': 'utf-8'
        }
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('网络响应错误: ' + response.status);
        }
        return response.text().then(text => {
          try {
            return JSON.parse(text);
          } catch (e) {
            console.error('JSON解析错误:', e);
            showNotification('错误', '文章数据格式错误', true);
            return [];
          }
        });
      })
      .then(articles => {
        // 隐藏加载通知
        hideNotification();
        
        allArticles = articles;
        // 加载文章到首页
        loadArticles();
        // 加载文章到管理页面
        loadManageArticles();
        // 更新分类统计
        updateCategoryCounts();
      })
      .catch(error => {
        console.error('加载文章失败:', error);
        showNotification('错误', '加载文章失败，请稍后重试', true);
      });
    }
    
    // 获取所有文章
    function getArticles() {
      return allArticles;
    }
    
    // 保存文章
    function saveArticle(article) {
      // 显示加载状态
      showNotification('处理中', article.id ? '正在更新文章...' : '正在发布文章...', false);
      
      // 准备更新的数据
      const articles = [...allArticles];
      let updatedArticles;
      
      if (article.id) {
        // 更新现有文章
        updatedArticles = articles.map(a => a.id === article.id ? article : a);
      } else {
        // 添加新文章
        article.id = Date.now(); // 使用时间戳作为唯一ID
        article.date = new Date().toISOString().split('T')[0]; // 格式化为YYYY-MM-DD
        // 估算阅读时间（假设每分钟阅读200字）
        const wordCount = article.content.replace(/[#*`\[\](){}]/g, '').length;
        article.readTime = Math.ceil(wordCount / 200);
        if (article.readTime < 1) article.readTime = 1;
        
        updatedArticles = [article, ...articles]; // 添加到数组开头
      }
      
      // 更新本地数据
      allArticles = updatedArticles;
      
      // 模拟API请求延迟
      setTimeout(() => {
        // 隐藏加载通知
        hideNotification();
        
        // 重新加载文章列表
        loadArticles();
        loadManageArticles(document.getElementById('manageSearchInput').value);
        // 更新分类统计
        updateCategoryCounts();
        
        return article;
      }, 800);
    }
    
    // 加载文章到首页
    function loadArticles(category = 'all') {
      const articles = getArticles();
      const articlesGrid = document.getElementById('articlesGrid');
      const noArticles = document.getElementById('noArticles');
      
      // 清空现有内容
      Array.from(articlesGrid.children).forEach(child => {
        if (child.id !== 'noArticles') {
          articlesGrid.removeChild(child);
        }
      });
      
      // 过滤文章
      let filteredArticles = articles;
      if (category !== 'all') {
        filteredArticles = articles.filter(article => article.category === category);
      }
      
      if (filteredArticles.length === 0) {
        // 没有文章时显示提示
        noArticles.classList.remove('hidden');
        return;
      }
      
      // 隐藏无文章提示
      noArticles.classList.add('hidden');
      
      // 显示文章
      filteredArticles.forEach((article, index) => {
        // 添加延迟动画效果
        setTimeout(() => {
          const articleCard = createArticleCard(article);
          articleCard.classList.add('fade-in', 'slide-up');
          articlesGrid.appendChild(articleCard);
        }, index * 100);
      });
    }
    
    // 创建文章卡片
    function createArticleCard(article) {
      const card = document.createElement('article');
      card.className = 'bg-white rounded-xl overflow-hidden shadow-md hover:shadow-xl card-hover';
      
      // 默认封面图
      const defaultCover = `https://picsum.photos/600/400?random=${article.id % 10}`;
      
      // 处理摘要 - 移除Markdown标记和LaTeX公式
      let summary = article.content
        .replace(/#{1,6}\s+/g, '') // 移除标题标记
        .replace(/\*\*|__/g, '') // 移除粗体标记
        .replace(/\*|_/g, '') // 移除斜体标记
        .replace(/`[^`]+`/g, '') // 移除代码标记
        .replace(/>/g, '') // 移除引用标记
        .replace(/\$\$[^$]+\$\$/g, '') // 移除块级LaTeX
        .replace(/\$[^$]+\$/g, '') // 移除行内LaTeX
        .replace(/!\[.*?\]\(.*?\)/g, '') // 移除图片标记
        .replace(/\[(.*?)\]\(.*?\)/g, '$1') // 移除链接标记保留文本
        .substring(0, 150);
      
      card.innerHTML = `
        <div class="h-48 overflow-hidden">
          <img src="${article.cover || defaultCover}" alt="${article.title}" class="w-full h-full object-cover transition-transform duration-500 hover:scale-110 opacity-0 transition-opacity duration-500">
        </div>
        <div class="p-6">
          <div class="flex items-center gap-2 text-sm text-neutral-600 mb-3 flex-wrap">
            <span class="bg-orange-light text-orange px-2 py-1 rounded-full">${article.category}</span>
            <span><i class="fa fa-calendar-o mr-1" aria-hidden="true"></i> ${article.date}</span>
            <span><i class="fa fa-clock-o mr-1" aria-hidden="true"></i> ${article.readTime}分钟阅读</span>
          </div>
          <h3 class="text-xl font-bold mb-3 hover:text-orange transition-colors">
            <a href="#" class="read-article" data-id="${article.id}">${article.title}</a>
          </h3>
          <p class="text-neutral-600 mb-4 line-clamp-3">
            ${summary}...
          </p>
          <div class="flex justify-between items-center">
            <a href="#" class="inline-flex items-center text-orange font-medium hover:underline read-article" data-id="${article.id}">
              阅读全文 <i class="fa fa-long-arrow-right ml-2" aria-hidden="true"></i>
            </a>
            <div class="flex gap-2">
              <button class="text-neutral-400 hover:text-orange transition-colors edit-article" data-id="${article.id}" title="编辑">
                <i class="fa fa-pencil" aria-hidden="true"></i>
              </button>
              <button class="text-neutral-400 hover:text-red-500 transition-colors delete-article" data-id="${article.id}" title="删除">
                <i class="fa fa-trash" aria-hidden="true"></i>
              </button>
            </div>
          </div>
        </div>
      `;
      
      // 图片加载完成后显示
      const img = card.querySelector('img');
      img.onload = () => {
        img.classList.add('opacity-100');
      };
      if (img.complete) {
        img.classList.add('opacity-100');
      }
      
      return card;
    }
    
    // 加载文章到阅读页面
    function loadArticleForReading(articleId) {
      const articles = getArticles();
      const article = articles.find(a => a.id === articleId);
      
      if (!article) {
        showNotification('错误', '找不到这篇文章', true);
        return;
      }
      
      // 更新当前文章ID
      currentArticleId = articleId;
      
      // 填充文章内容
      document.getElementById('articleReadTitle').textContent = article.title;
      document.getElementById('articleReadCategory').textContent = article.category;
      document.getElementById('articleReadDate').innerHTML = `<i class="fa fa-calendar-o mr-1" aria-hidden="true"></i> ${article.date}`;
      document.getElementById('articleReadTime').innerHTML = `<i class="fa fa-clock-o mr-1" aria-hidden="true"></i> ${article.readTime}分钟阅读`;
      
      // 渲染Markdown和LaTeX
      const contentElement = document.getElementById('articleReadContent');
      contentElement.innerHTML = marked.parse(article.content);
      
      // 渲染LaTeX公式
      renderMathInElement(contentElement, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false}
        ]
      });
      
      // 设置封面图
      const coverImg = document.getElementById('articleReadCover');
      const defaultCover = `https://picsum.photos/600/400?random=${article.id % 10}`;
      coverImg.src = article.cover || defaultCover;
      coverImg.alt = article.title;
      
      // 设置编辑和删除按钮的文章ID
      document.querySelector('.edit-article[data-id=""]').setAttribute('data-id', article.id);
      document.querySelector('.delete-article[data-id=""]').setAttribute('data-id', article.id);
      
      // 处理上下篇导航
      updateArticleNavigation(articleId);
      
      // 切换到阅读页面
      document.querySelectorAll('.page-content').forEach(pageEl => {
        pageEl.classList.add('hidden');
      });
      document.getElementById('articlePage').classList.remove('hidden');
      
      // 滚动到顶部
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    }
    
    // 更新文章导航（上一篇/下一篇）
    function updateArticleNavigation(currentId) {
      const articles = getArticles();
      // 按日期排序文章（最新在前）
      const sortedArticles = sortArticles([...articles], 'newest');
      const currentIndex = sortedArticles.findIndex(a => a.id === currentId);
      
      // 上一篇
      const prevArticleContainer = document.getElementById('prevArticleContainer');
      const prevArticleTitle = document.getElementById('prevArticleTitle');
      const prevArticleLink = document.querySelector('.prev-article-link');
      
      if (currentIndex < sortedArticles.length - 1) {
        const prevArticle = sortedArticles[currentIndex + 1];
        prevArticleTitle.textContent = prevArticle.title;
        prevArticleLink.setAttribute('data-id', prevArticle.id);
        prevArticleContainer.classList.remove('hidden');
      } else {
        prevArticleContainer.classList.add('hidden');
        prevArticleLink.setAttribute('data-id', '');
      }
      
      // 下一篇
      const nextArticleContainer = document.getElementById('nextArticleContainer');
      const nextArticleTitle = document.getElementById('nextArticleTitle');
      const nextArticleLink = document.querySelector('.next-article-link');
      
      if (currentIndex > 0) {
        const nextArticle = sortedArticles[currentIndex - 1];
        nextArticleTitle.textContent = nextArticle.title;
        nextArticleLink.setAttribute('data-id', nextArticle.id);
        nextArticleContainer.classList.remove('hidden');
      } else {
        nextArticleContainer.classList.add('hidden');
        nextArticleLink.setAttribute('data-id', '');
      }
    }
    
    // 加载文章到管理页面
    function loadManageArticles(searchQuery = '') {
      let articles = getArticles();
      const tableBody = document.getElementById('manageArticlesTable');
      const noArticlesManage = document.getElementById('noArticlesManage');
      
      // 清空现有内容
      Array.from(tableBody.children).forEach(child => {
        if (child.id !== 'noArticlesManage') {
          tableBody.removeChild(child);
        }
      });
      
      // 搜索过滤
      if (searchQuery) {
        const query = searchQuery.toLowerCase();
        articles = articles.filter(article => 
          article.title.toLowerCase().includes(query) || 
          article.category.toLowerCase().includes(query) ||
          article.content.toLowerCase().includes(query)
        );
      }
      
      // 排序
      articles = sortArticles([...articles], currentSort);
      
      // 分页处理
      const totalArticles = articles.length;
      const totalPages = Math.ceil(totalArticles / articlesPerPage);
      const startIndex = (currentPage - 1) * articlesPerPage;
      const endIndex = startIndex + articlesPerPage;
      const paginatedArticles = articles.slice(startIndex, endIndex);
      
      // 更新分页信息
      document.getElementById('showingCount').textContent = paginatedArticles.length;
      document.getElementById('totalCount').textContent = totalArticles;
      
      // 更新分页按钮状态
      document.getElementById('prevPageBtn').disabled = currentPage === 1;
      document.getElementById('nextPageBtn').disabled = currentPage === totalPages || totalPages === 0;
      
      if (totalArticles === 0) {
        // 没有文章时显示提示
        noArticlesManage.classList.remove('hidden');
        document.getElementById('batchDeleteBtn').classList.add('hidden');
        return;
      }
      
      // 隐藏无文章提示
      noArticlesManage.classList.add('hidden');
      
      // 显示批量删除按钮（如果有文章）
      document.getElementById('batchDeleteBtn').classList.remove('hidden');
      
      // 显示文章
      paginatedArticles.forEach(article => {
        const row = document.createElement('tr');
        row.className = 'border-b border-neutral-200';
        row.innerHTML = `
          <td class="py-3 px-4">
            <input type="checkbox" class="article-checkbox rounded text-orange focus:ring-orange" data-id="${article.id}">
          </td>
          <td class="py-3 px-4">
            <div class="font-medium hover:text-orange transition-colors read-article" data-id="${article.id}">${article.title}</div>
          </td>
          <td class="py-3 px-4 hidden md:table-cell">
            <span class="bg-orange-light text-orange px-2 py-1 rounded-full text-sm">${article.category}</span>
          </td>
          <td class="py-3 px-4 hidden sm:table-cell text-neutral-600">${article.date}</td>
          <td class="py-3 px-4 hidden lg:table-cell text-neutral-600">${article.readTime} 分钟</td>
          <td class="py-3 px-4 text-right">
            <div class="flex justify-end gap-2">
              <button class="text-neutral-600 hover:text-orange transition-colors edit-article" data-id="${article.id}" title="编辑">
                <i class="fa fa-pencil" aria-hidden="true"></i>
              </button>
              <button class="text-neutral-600 hover:text-red-500 transition-colors delete-article" data-id="${article.id}" title="删除">
                <i class="fa fa-trash" aria-hidden="true"></i>
              </button>
            </div>
          </td>
        `;
        tableBody.appendChild(row);
      });
      
      // 重置选中状态
      selectedArticleIds = [];
      document.getElementById('selectAllCheckbox').checked = false;
    }
    
    // 排序文章
    function sortArticles(articles, sortType) {
      switch (sortType) {
        case 'newest':
          return articles.sort((a, b) => new Date(b.date) - new Date(a.date));
        case 'oldest':
          return articles.sort((a, b) => new Date(a.date) - new Date(b.date));
        case 'title-asc':
          return articles.sort((a, b) => a.title.localeCompare(b.title));
        case 'title-desc':
          return articles.sort((a, b) => b.title.localeCompare(a.title));
        case 'category':
          return articles.sort((a, b) => a.category.localeCompare(b.category));
        default:
          return articles;
      }
    }
    
    // 更新分类统计
    function updateCategoryCounts() {
      const articles = getArticles();
      const counts = {
        '技术': 0,
        '生活': 0,
        '思考': 0,
        '旅行': 0,
        '阅读': 0
      };
      
      articles.forEach(article => {
        if (counts.hasOwnProperty(article.category)) {
          counts[article.category]++;
        }
      });
      
      document.getElementById('techCount').textContent = counts['技术'];
      document.getElementById('lifeCount').textContent = counts['生活'];
      document.getElementById('thoughtCount').textContent = counts['思考'];
    }
    
    // 显示通知
    function showNotification(title, message, isError = false) {
      const notification = document.getElementById('notification');
      const notificationTitle = document.getElementById('notificationTitle');
      const notificationMessage = document.getElementById('notificationMessage');
      const notificationIcon = document.getElementById('notificationIcon');
      
      notificationTitle.textContent = title;
      notificationMessage.textContent = message;
      
      // 设置图标和颜色
      if (isError) {
        notificationIcon.className = 'text-red-500 mt-0.5';
        notificationIcon.innerHTML = '<i class="fa fa-exclamation-circle text-xl" aria-hidden="true"></i>';
      } else {
        notificationIcon.className = 'text-green-500 mt-0.5';
        notificationIcon.innerHTML = '<i class="fa fa-check-circle text-xl" aria-hidden="true"></i>';
      }
      
      // 显示通知
      notification.style.transform = 'translateX(0)';
      
      // 3秒后自动隐藏
      setTimeout(hideNotification, 3000);
    }
    
    // 隐藏通知
    function hideNotification() {
      const notification = document.getElementById('notification');
      notification.style.transform = 'translateX(calc(100% + 20px))';
    }
    
    // 删除文章
    function deleteArticle(id) {
      // 显示加载状态
      showNotification('处理中', '正在删除文章...', false);
      
      // 过滤掉要删除的文章
      allArticles = getArticles().filter(a => a.id !== id);
      
      // 模拟API请求延迟
      setTimeout(() => {
        // 隐藏加载通知
        hideNotification();
        
        // 重新加载文章列表
        loadArticles();
        loadManageArticles(document.getElementById('manageSearchInput').value);
        // 更新分类统计
        updateCategoryCounts();
        
        // 如果当前在阅读页面，返回首页
        if (!document.getElementById('articlePage').classList.contains('hidden')) {
          document.querySelectorAll('.page-content').forEach(pageEl => {
            pageEl.classList.add('hidden');
          });
          document.getElementById('homePage').classList.remove('hidden');
        }
        
        showNotification('成功', '文章已删除');
      }, 800);
    }
    
    // 批量删除文章
    function batchDeleteArticles(ids) {
      if (ids.length === 0) return;
      
      // 显示加载状态
      showNotification('处理中', `正在删除 ${ids.length} 篇文章...`, false);
      
      // 过滤掉要删除的文章
      allArticles = getArticles().filter(a => !ids.includes(a.id));
      
      // 模拟API请求延迟
      setTimeout(() => {
        // 隐藏加载通知
        hideNotification();
        
        // 重新加载文章列表
        loadArticles();
        loadManageArticles(document.getElementById('manageSearchInput').value);
        // 更新分类统计
        updateCategoryCounts();
        
        showNotification('成功', `已删除 ${ids.length} 篇文章`);
      }, 800);
    }
    
    // 切换编辑模式
    function switchEditMode(mode) {
      currentEditMode = mode;
      
      // 更新按钮状态
      document.querySelectorAll('.edit-mode-tabs button').forEach(btn => {
        btn.classList.remove('active', 'bg-orange', 'text-white');
        btn.classList.add('text-neutral-600');
      });
      
      const activeBtn = mode === 'markdown' ? '#markdownModeBtn' : 
                       mode === 'preview' ? '#previewModeBtn' : '#splitModeBtn';
      document.querySelector(activeBtn).classList.add('active', 'bg-orange', 'text-white');
      document.querySelector(activeBtn).classList.remove('text-neutral-600');
      
      // 隐藏所有编辑区域
      document.getElementById('markdownEditor').classList.add('hidden');
      document.getElementById('previewArea').classList.add('hidden');
      document.getElementById('splitEditor').classList.add('hidden');
      
      // 显示选中的编辑区域
      if (mode === 'markdown') {
        document.getElementById('markdownEditor').classList.remove('hidden');
      } else if (mode === 'preview') {
        document.getElementById('previewArea').classList.remove('hidden');
        updatePreview();
      } else if (mode === 'split') {
        document.getElementById('splitEditor').classList.remove('hidden');
        // 同步内容
        document.getElementById('splitArticleContent').value = 
          document.getElementById('articleContent').value;
        updateSplitPreview();
      }
    }
    
    // 更新预览内容
    function updatePreview() {
      const content = document.getElementById('articleContent').value;
      const previewArea = document.getElementById('previewArea');
      previewArea.innerHTML = marked.parse(content || '<p>无内容</p>');
      
      // 渲染LaTeX公式
      renderMathInElement(previewArea, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false}
        ]
      });
    }
    
    // 更新分屏预览
    function updateSplitPreview() {
      const content = document.getElementById('splitArticleContent').value;
      const previewArea = document.getElementById('splitPreviewArea');
      previewArea.innerHTML = marked.parse(content || '<p>无内容</p>');
      
      // 渲染LaTeX公式
      renderMathInElement(previewArea, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false}
        ]
      });
    }
    
    // 初始化事件监听
    function initEventListeners() {
      // 移动端菜单切换
      const menuBtn = document.getElementById('menuBtn');
      const mobileMenu = document.getElementById('mobileMenu');
      
      menuBtn.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
        mobileMenu.classList.toggle('slide-down');
      });
      
      // 页面切换
      document.querySelectorAll('[data-page]').forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const page = this.getAttribute('data-page');
          
          // 隐藏所有页面
          document.querySelectorAll('.page-content').forEach(pageEl => {
            pageEl.classList.add('hidden');
          });
          
          // 显示目标页面
          document.getElementById(`${page}Page`).classList.remove('hidden');
          
          // 关闭移动菜单
          mobileMenu.classList.add('hidden');
          
          // 如果切换到管理页面，重新加载文章
          if (page === 'manage') {
            currentPage = 1;
            loadManageArticles();
          }
          
          // 滚动到顶部
          window.scrollTo({
            top: 0,
            behavior: 'smooth'
          });
        });
      });
      
      // 返回顶部按钮
      const backToTopBtn = document.getElementById('backToTop');
      
      window.addEventListener('scroll', () => {
        if (window.scrollY > 300) {
          backToTopBtn.classList.remove('opacity-0', 'invisible');
          backToTopBtn.classList.add('opacity-100', 'visible');
        } else {
          backToTopBtn.classList.remove('opacity-100', 'visible');
          backToTopBtn.classList.add('opacity-0', 'invisible');
        }
        
        // 导航栏滚动效果
        const header = document.querySelector('header');
        if (window.scrollY > 100) {
          header.classList.add('py-2');
          header.classList.remove('py-4');
        } else {
          header.classList.add('py-4');
          header.classList.remove('py-2');
        }
      });
      
      backToTopBtn.addEventListener('click', () => {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });
      
      // 文章表单提交
      const articleForm = document.getElementById('articleForm');
      
      articleForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // 获取表单数据
        let content;
        if (currentEditMode === 'split') {
          content = document.getElementById('splitArticleContent').value;
        } else {
          content = document.getElementById('articleContent').value;
        }
        
        const article = {
          id: document.getElementById('articleId').value ? parseInt(document.getElementById('articleId').value) : null,
          title: document.getElementById('articleTitle').value,
          category: document.getElementById('articleCategory').value,
          cover: document.getElementById('articleCover').value,
          content: content
        };
        
        // 验证表单
        if (!article.title || !article.category || !article.content.trim()) {
          showNotification('错误', '请填写标题、分类和内容', true);
          return;
        }
        
        // 保存文章
        const savedArticle = saveArticle(article);
        
        // 重置表单
        resetArticleForm();
        
        // 显示成功通知
        showNotification('成功', article.id ? '文章已更新' : '文章已发布');
        
        // 切换到首页
        document.querySelectorAll('.page-content').forEach(pageEl => {
          pageEl.classList.add('hidden');
        });
        document.getElementById('homePage').classList.remove('hidden');
      });
      
      // 重置文章表单
      function resetArticleForm() {
        document.getElementById('articleForm').reset();
        document.getElementById('articleId').value = '';
        document.getElementById('articleContent').value = '';
        document.getElementById('splitArticleContent').value = '';
        document.getElementById('submitBtnText').textContent = '发布文章';
        // 切换到Markdown编辑模式
        switchEditMode('markdown');
      }
      
      // 取消编辑按钮
      document.getElementById('cancelEditBtn').addEventListener('click', function() {
        resetArticleForm();
        
        // 切换到首页
        document.querySelectorAll('.page-content').forEach(pageEl => {
          pageEl.classList.add('hidden');
        });
        document.getElementById('homePage').classList.remove('hidden');
      });
      
      // 分类筛选
      document.querySelectorAll('.category-filter').forEach(button => {
        button.addEventListener('click', function() {
          // 更新按钮样式
          document.querySelectorAll('.category-filter').forEach(btn => {
            btn.classList.remove('bg-orange', 'text-white');
            btn.classList.add('bg-white', 'border', 'border-neutral-300', 'hover:border-orange', 'hover:text-orange');
          });
          this.classList.remove('bg-white', 'border', 'border-neutral-300', 'hover:border-orange', 'hover:text-orange');
          this.classList.add('bg-orange', 'text-white');
          
          // 加载对应分类的文章
          const category = this.getAttribute('data-category');
          loadArticles(category);
        });
      });
      
      // 编辑模式切换
      document.getElementById('markdownModeBtn').addEventListener('click', () => {
        // 同步内容
        if (currentEditMode === 'split') {
          document.getElementById('articleContent').value = 
            document.getElementById('splitArticleContent').value;
        }
        switchEditMode('markdown');
      });
      
      document.getElementById('previewModeBtn').addEventListener('click', () => {
        // 同步内容
        if (currentEditMode === 'split') {
          document.getElementById('articleContent').value = 
            document.getElementById('splitArticleContent').value;
        }
        switchEditMode('preview');
      });
      
      document.getElementById('splitModeBtn').addEventListener('click', () => {
        // 同步内容
        document.getElementById('splitArticleContent').value = 
          document.getElementById('articleContent').value;
        switchEditMode('split');
      });
      
      // 分屏编辑区内容变化时更新预览
      document.getElementById('splitArticleContent').addEventListener('input', updateSplitPreview);
      
      // 编辑器工具栏 - Markdown功能
      document.querySelectorAll('.editor-toolbar button').forEach(button => {
        button.addEventListener('click', function() {
          const action = this.getAttribute('data-action');
          let textarea, start, end, selectedText;
          
          // 根据当前编辑模式选择正确的textarea
          if (currentEditMode === 'split') {
            textarea = document.getElementById('splitArticleContent');
          } else {
            textarea = document.getElementById('articleContent');
          }
          
          // 确保textarea获得焦点
          textarea.focus();
          
          // 获取选中的文本和位置
          start = textarea.selectionStart;
          end = textarea.selectionEnd;
          selectedText = textarea.value.substring(start, end);
          
          let newText, newCursorPos;
          
          switch (action) {
            case 'heading1':
              newText = `# ${selectedText || '一级标题'}`;
              newCursorPos = start + (selectedText ? newText.length : 4);
              break;
            case 'heading2':
              newText = `## ${selectedText || '二级标题'}`;
              newCursorPos = start + (selectedText ? newText.length : 5);
              break;
            case 'heading3':
              newText = `### ${selectedText || '三级标题'}`;
              newCursorPos = start + (selectedText ? newText.length : 6);
              break;
            case 'bold':
              newText = `**${selectedText || '粗体文本'}**`;
              newCursorPos = start + (selectedText ? newText.length : 8);
              break;
            case 'italic':
              newText = `*${selectedText || '斜体文本'}*`;
              newCursorPos = start + (selectedText ? newText.length : 6);
              break;
            case 'strikethrough':
              newText = `~~${selectedText || '删除线文本'}~~`;
              newCursorPos = start + (selectedText ? newText.length : 8);
              break;
            case 'link':
              const linkText = selectedText || '链接文本';
              const url = prompt('请输入链接地址:', 'https://');
              if (url) {
                newText = `[${linkText}](${url})`;
                newCursorPos = start + newText.length;
              } else {
                return; // 用户取消
              }
              break;
            case 'image':
              const altText = selectedText || '图片描述';
              const imgUrl = prompt('请输入图片URL:', 'https://');
              if (imgUrl) {
                newText = `![${altText}](${imgUrl})`;
                newCursorPos = start + newText.length;
              } else {
                return; // 用户取消
              }
              break;
            case 'code':
              newText = `\`${selectedText || '代码'}\``;
              newCursorPos = start + (selectedText ? newText.length : 6);
              break;
            case 'quote':
              newText = `> ${selectedText || '引用内容'}`;
              newCursorPos = start + (selectedText ? newText.length : 4);
              break;
            case 'unordered-list':
              newText = `- ${selectedText || '列表项'}`;
              newCursorPos = start + (selectedText ? newText.length : 4);
              break;
            case 'ordered-list':
              newText = `1. ${selectedText || '列表项'}`;
              newCursorPos = start + (selectedText ? newText.length : 5);
              break;
            case 'latex':
              if (selectedText) {
                newText = `$${selectedText}$`;
              } else {
                newText = `$公式$`;
                newCursorPos = start + 2; // 光标放在$之间
              }
              newCursorPos = start + (selectedText ? newText.length : 2);
              break;
            case 'table':
              newText = `| 表头1 | 表头2 | 表头3 |
| --- | --- | --- |
| 内容1 | 内容2 | 内容3 |
| 内容4 | 内容5 | 内容6 |`;
              newCursorPos = start + newText.length;
              break;
            case 'hr':
              newText = `---`;
              newCursorPos = start + 3;
              break;
            default:
              return;
          }
          
          // 替换选中的文本
          textarea.value = 
            textarea.value.substring(0, start) + 
            newText + 
            textarea.value.substring(end);
          
          // 设置光标位置
          textarea.selectionStart = newCursorPos;
          textarea.selectionEnd = newCursorPos;
          
          // 如果是预览模式或分屏模式，更新预览
          if (currentEditMode === 'preview') {
            updatePreview();
          } else if (currentEditMode === 'split') {
            updateSplitPreview();
          }
        });
      });
      
      // 格式帮助按钮
      const helpBtn = document.getElementById('helpBtn');
      const helpModal = document.getElementById('helpModal');
      const closeHelpBtn = document.getElementById('closeHelpBtn');
      
      helpBtn.addEventListener('click', function() {
        helpModal.classList.remove('hidden');
      });
      
      closeHelpBtn.addEventListener('click', function() {
        helpModal.classList.add('hidden');
      });
      
      // 点击帮助模态框外部关闭
      helpModal.addEventListener('click', function(e) {
        if (e.target === helpModal) {
          helpModal.classList.add('hidden');
        }
      });
      
      // 关闭通知
      document.getElementById('closeNotification').addEventListener('click', hideNotification);
      
      // 全局事件委托 - 处理所有动态生成的文章相关操作
      document.addEventListener('click', function(e) {
        // 阅读文章
        if (e.target.closest('.read-article')) {
          e.preventDefault();
          const link = e.target.closest('.read-article');
          const id = parseInt(link.getAttribute('data-id'));
          if (!isNaN(id)) {
            loadArticleForReading(id);
          }
        }
        
        // 编辑文章
        if (e.target.closest('.edit-article')) {
          e.preventDefault();
          const link = e.target.closest('.edit-article');
          const id = parseInt(link.getAttribute('data-id'));
          if (!isNaN(id)) {
            const articles = getArticles();
            const article = articles.find(a => a.id === id);
            
            if (article) {
              // 填充表单
              document.getElementById('articleId').value = article.id;
              document.getElementById('articleTitle').value = article.title;
              document.getElementById('articleCategory').value = article.category;
              document.getElementById('articleCover').value = article.cover || '';
              document.getElementById('articleContent').value = article.content;
              document.getElementById('splitArticleContent').value = article.content;
              document.getElementById('submitBtnText').textContent = '更新文章';
              
              // 切换到写文章页面
              document.querySelectorAll('.page-content').forEach(pageEl => {
                pageEl.classList.add('hidden');
              });
              document.getElementById('writePage').classList.remove('hidden');
              
              // 切换到Markdown编辑模式
              switchEditMode('markdown');
              
              // 滚动到顶部
              window.scrollTo({
                top: 0,
                behavior: 'smooth'
              });
            }
          }
        }
        
        // 删除文章
        if (e.target.closest('.delete-article')) {
          e.preventDefault();
          const link = e.target.closest('.delete-article');
          const id = parseInt(link.getAttribute('data-id'));
          if (!isNaN(id)) {
            articleToDelete = id;
            // 显示删除确认模态框
            document.getElementById('deleteConfirmModal').classList.remove('hidden');
          }
        }
        
        // 上一篇/下一篇导航
        if (e.target.closest('.prev-article-link')) {
          e.preventDefault();
          const link = e.target.closest('.prev-article-link');
          const id = parseInt(link.getAttribute('data-id'));
          if (!isNaN(id)) {
            loadArticleForReading(id);
          }
        }
        
        if (e.target.closest('.next-article-link')) {
          e.preventDefault();
          const link = e.target.closest('.next-article-link');
          const id = parseInt(link.getAttribute('data-id'));
          if (!isNaN(id)) {
            loadArticleForReading(id);
          }
        }
        
        // 返回文章列表
        if (e.target.closest('.back-to-list')) {
          e.preventDefault();
          document.querySelectorAll('.page-content').forEach(pageEl => {
            pageEl.classList.add('hidden');
          });
          document.getElementById('homePage').classList.remove('hidden');
        }
      });
      
      // 删除确认模态框操作
      document.getElementById('cancelDeleteBtn').addEventListener('click', function() {
        document.getElementById('deleteConfirmModal').classList.add('hidden');
        articleToDelete = null;
      });
      
      document.getElementById('confirmDeleteBtn').addEventListener('click', function() {
        if (articleToDelete !== null) {
          deleteArticle(articleToDelete);
        }
        document.getElementById('deleteConfirmModal').classList.add('hidden');
        articleToDelete = null;
      });
      
      // 点击删除模态框外部关闭
      document.getElementById('deleteConfirmModal').addEventListener('click', function(e) {
        if (e.target === this) {
          this.classList.add('hidden');
          articleToDelete = null;
        }
      });
      
      // 排序按钮事件
      document.querySelectorAll('.sort-btn').forEach(button => {
        button.addEventListener('click', function() {
          const sortType = this.getAttribute('data-sort');
          
          // 更新按钮样式
          document.querySelectorAll('.sort-btn').forEach(btn => {
            btn.classList.remove('active');
          });
          this.classList.add('active');
          
          // 更新排序方式并重新加载文章
          currentSort = sortType;
          currentPage = 1; // 重置到第一页
          loadManageArticles(document.getElementById('manageSearchInput').value);
        });
      });
      
      // 搜索功能
      const searchInput = document.getElementById('manageSearchInput');
      searchInput.addEventListener('input', function() {
        currentPage = 1; // 重置到第一页
        loadManageArticles(this.value);
      });
      
      // 分页按钮
      document.getElementById('prevPageBtn').addEventListener('click', function() {
        if (currentPage > 1) {
          currentPage--;
          loadManageArticles(searchInput.value);
          scrollToTopOfManageTable();
        }
      });
      
      document.getElementById('nextPageBtn').addEventListener('click', function() {
        const totalArticles = getArticles().length;
        const totalPages = Math.ceil(totalArticles / articlesPerPage);
        
        if (currentPage < totalPages) {
          currentPage++;
          loadManageArticles(searchInput.value);
          scrollToTopOfManageTable();
        }
      });
      
      // 滚动到管理表格顶部
      function scrollToTopOfManageTable() {
        const manageTable = document.getElementById('manageArticlesTable').closest('.overflow-x-auto');
        if (manageTable) {
          manageTable.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }
      
      // 全选复选框
      document.getElementById('selectAllCheckbox').addEventListener('change', function() {
        const isChecked = this.checked;
        const checkboxes = document.querySelectorAll('.article-checkbox');
        
        checkboxes.forEach(checkbox => {
          checkbox.checked = isChecked;
        });
        
        // 更新选中的文章ID
        updateSelectedArticleIds();
      });
      
      // 文章复选框事件委托
      document.addEventListener('change', function(e) {
        if (e.target.classList.contains('article-checkbox')) {
          // 更新全选框状态
          updateSelectAllStatus();
          // 更新选中的文章ID
          updateSelectedArticleIds();
        }
      });
      
      // 更新全选框状态
      function updateSelectAllStatus() {
        const checkboxes = document.querySelectorAll('.article-checkbox');
        const checkedBoxes = document.querySelectorAll('.article-checkbox:checked');
        document.getElementById('selectAllCheckbox').checked = checkboxes.length > 0 && checkboxes.length === checkedBoxes.length;
      }
      
      // 更新选中的文章ID
      function updateSelectedArticleIds() {
        const checkedBoxes = document.querySelectorAll('.article-checkbox:checked');
        selectedArticleIds = Array.from(checkedBoxes).map(checkbox => parseInt(checkbox.getAttribute('data-id')));
        
        // 更新批量删除按钮状态
        const batchDeleteBtn = document.getElementById('batchDeleteBtn');
        if (selectedArticleIds.length > 0) {
          batchDeleteBtn.classList.remove('hidden');
          batchDeleteBtn.innerHTML = `<i class="fa fa-trash" aria-hidden="true"></i> 批量删除 (${selectedArticleIds.length})`;
        } else {
          batchDeleteBtn.classList.add('hidden');
          batchDeleteBtn.innerHTML = `<i class="fa fa-trash" aria-hidden="true"></i> 批量删除`;
        }
      }
      
      // 批量删除按钮
      document.getElementById('batchDeleteBtn').addEventListener('click', function() {
        if (selectedArticleIds.length === 0) return;
        
        if (confirm(`确定要删除选中的 ${selectedArticleIds.length} 篇文章吗？此操作无法撤销。`)) {
          batchDeleteArticles(selectedArticleIds);
          // 重置选中状态
          selectedArticleIds = [];
          document.getElementById('selectAllCheckbox').checked = false;
          document.getElementById('batchDeleteBtn').innerHTML = `<i class="fa fa-trash" aria-hidden="true"></i> 批量删除`;
        }
      });
      
      // 新建文章按钮
      document.getElementById('addNewArticleBtn').addEventListener('click', function() {
        // 重置表单
        resetArticleForm();
        
        // 切换到写文章页面
        document.querySelectorAll('.page-content').forEach(pageEl => {
          pageEl.classList.add('hidden');
        });
        document.getElementById('writePage').classList.remove('hidden');
        
        // 滚动到顶部
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });
    }
  </script>
</body>
</html>
