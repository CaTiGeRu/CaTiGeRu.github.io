<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>大柯的blog</title>
  <!-- 引入外部依赖 -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/marked@4.0.2/marked.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"></script>
  
  <!-- Tailwind自定义配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            orange: {
              light: '#FFE0B2',
              DEFAULT: '#FF9800',
              dark: '#E65100',
            },
            neutral: {
              100: '#F5F5F5',
              200: '#EEEEEE',
              300: '#E0E0E0',
              600: '#757575',
              700: '#616161',
              800: '#424242',
              900: '#212121',
            }
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <!-- 自定义工具类 -->
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto { content-visibility: auto; }
      .text-shadow { text-shadow: 0 2px 4px rgba(0,0,0,0.1); }
      .card-hover { transition: all 0.3s ease; }
      .card-hover:hover { transform: translateY(-5px); }
      .fade-in { animation: fadeIn 0.5s ease-in-out; }
      .slide-up { animation: slideUp 0.5s ease-out; }
      .slide-down { animation: slideDown 0.3s ease-in-out; }
      .scale-in { animation: scaleIn 0.3s ease-in-out; }
    }
  </style>
  
  <!-- 全局样式 -->
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    html { scroll-behavior: smooth; }
    
    /* 渐变背景动画 */
    .gradient-bg {
      background: linear-gradient(135deg, #FF9800 0%, #E65100 100%);
      background-size: 200% 200%;
      animation: gradientShift 8s ease infinite;
    }
    
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    @keyframes slideDown { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    
    /* Markdown预览样式 */
    .markdown-preview h1 { font-size: 2em; margin: 0.67em 0; }
    .markdown-preview h2 { font-size: 1.5em; margin: 0.83em 0; }
    .markdown-preview h3 { font-size: 1.17em; margin: 1em 0; }
    .markdown-preview p { margin: 1em 0; line-height: 1.8; }
    .markdown-preview ul, .markdown-preview ol { margin: 1em 0 1em 2em; line-height: 1.8; }
    .markdown-preview blockquote { border-left: 4px solid #FF9800; padding-left: 1em; margin: 1em 0; color: #616161; }
    .markdown-preview pre { background: #f5f5f5; padding: 1em; border-radius: 4px; overflow-x: auto; margin: 1em 0; }
    .markdown-preview code { background: #f5f5f5; padding: 0.2em 0.4em; border-radius: 4px; }
    .markdown-preview img { max-width: 100%; height: auto; margin: 1em 0; border-radius: 4px; }
    .markdown-preview a { color: #FF9800; text-decoration: none; }
    .markdown-preview a:hover { text-decoration: underline; }
    .markdown-preview table { border-collapse: collapse; margin: 1em 0; width: 100%; }
    .markdown-preview th, .markdown-preview td { border: 1px solid #ddd; padding: 0.8em; text-align: left; }
    .markdown-preview th { background-color: #f5f5f5; }
    
    /* 编辑器样式 */
    .editor-toolbar button { transition: all 0.2s ease; }
    .editor-toolbar button:hover { background-color: #FFE0B2; transform: scale(1.1); }
    .editor-content:focus { outline: none; box-shadow: 0 0 0 2px rgba(255, 152, 0, 0.3); }
    .markdown-editor { font-family: 'Consolas', 'Monaco', monospace; line-height: 1.6; }
  </style>
</head>

<body class="bg-neutral-100 font-sans text-neutral-800">
  <!-- 导航栏 -->
  <header class="sticky top-0 z-50 bg-white/90 backdrop-blur-sm shadow-sm transition-all duration-300">
    <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
      <a href="#" class="text-xl font-bold text-orange-dark flex items-center gap-2">
        <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
        <span>大柯的blog</span>
      </a>
      
      <!-- 桌面导航 -->
      <div class="hidden md:flex items-center gap-6">
        <a href="#" class="font-medium hover:text-orange transition-colors" data-page="home">首页</a>
        <a href="#" class="font-medium hover:text-orange transition-colors" data-page="categories">分类</a>
        <a href="#" class="font-medium hover:text-orange transition-colors" data-page="manage">管理文章</a>
        <a href="#" class="font-medium hover:text-orange transition-colors" data-page="about">关于</a>
        <a href="#" class="font-medium hover:text-orange transition-colors" data-page="write">
          <i class="fa fa-plus-circle mr-1" aria-hidden="true"></i> 写文章
        </a>
        <button class="bg-orange hover:bg-orange-dark text-white px-4 py-2 rounded-full transition-colors">
          <i class="fa fa-search mr-1" aria-hidden="true"></i> 搜索
        </button>
      </div>
      
      <!-- 移动端菜单按钮 -->
      <button class="md:hidden text-neutral-800 hover:text-orange transition-colors" id="menuBtn">
        <i class="fa fa-bars text-xl" aria-hidden="true"></i>
      </button>
    </nav>
    
    <!-- 移动端导航菜单 -->
    <div class="md:hidden hidden bg-white border-t" id="mobileMenu">
      <div class="container mx-auto px-4 py-3 flex flex-col gap-3">
        <a href="#" class="py-2 font-medium hover:text-orange transition-colors" data-page="home">首页</a>
        <a href="#" class="py-2 font-medium hover:text-orange transition-colors" data-page="categories">分类</a>
        <a href="#" class="py-2 font-medium hover:text-orange transition-colors" data-page="manage">管理文章</a>
        <a href="#" class="py-2 font-medium hover:text-orange transition-colors" data-page="about">关于</a>
        <a href="#" class="py-2 font-medium hover:text-orange transition-colors" data-page="write">
          <i class="fa fa-plus-circle mr-1" aria-hidden="true"></i> 写文章
        </a>
        <div class="relative">
          <input type="text" placeholder="搜索文章..." class="w-full px-4 py-2 rounded-full border border-neutral-300 focus:outline-none focus:ring-2 focus:ring-orange/50">
          <button class="absolute right-3 top-1/2 transform -translate-y-1/2 text-neutral-600">
            <i class="fa fa-search" aria-hidden="true"></i>
          </button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <!-- 页面容器 -->
    <div id="pageContainer">
      <!-- 首页内容 -->
      <div id="homePage" class="page-content">
        <!-- 博客标题区域 -->
        <section class="gradient-bg text-white py-16 md:py-24">
          <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl md:text-6xl font-bold mb-4 text-shadow">大柯的blog</h1>
            <p class="text-lg md:text-xl max-w-2xl mx-auto opacity-90">支持Markdown和LaTeX的个人博客空间</p>
          </div>
        </section>
        
        <!-- 文章列表区域 -->
        <section class="container mx-auto px-4 py-12">
          <div class="flex justify-between items-center mb-8 flex-wrap gap-4">
            <h2 class="text-2xl font-bold text-neutral-800">最新文章</h2>
            <div class="flex gap-2">
              <button class="px-3 py-1 rounded-full bg-orange text-white text-sm category-filter" data-category="all">全部</button>
              <button class="px-3 py-1 rounded-full bg-white border border-neutral-300 hover:border-orange hover:text-orange text-sm transition-colors category-filter" data-category="技术">技术</button>
              <button class="px-3 py-1 rounded-full bg-white border border-neutral-300 hover:border-orange hover:text-orange text-sm transition-colors category-filter" data-category="生活">生活</button>
              <button class="px-3 py-1 rounded-full bg-white border border-neutral-300 hover:border-orange hover:text-orange text-sm transition-colors category-filter" data-category="思考">思考</button>
            </div>
          </div>
          
          <!-- 文章网格 -->
          <div id="articlesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <div id="noArticles" class="col-span-full text-center py-16 hidden">
              <i class="fa fa-file-text-o text-6xl text-neutral-300 mb-4" aria-hidden="true"></i>
              <p class="text-neutral-600 text-lg">还没有发布任何文章</p>
              <a href="#" class="inline-block mt-4 text-orange hover:underline font-medium" data-page="write">
                <i class="fa fa-pencil mr-1" aria-hidden="true"></i> 写第一篇文章
              </a>
            </div>
          </div>
          
          <!-- 加载更多按钮 -->
          <div class="mt-12 text-center">
            <button id="loadMoreBtn" class="px-6 py-3 bg-white border-2 border-orange text-orange rounded-full font-medium hover:bg-orange hover:text-white transition-colors duration-300 hidden">
              加载更多文章 <i class="fa fa-refresh ml-2" aria-hidden="true"></i>
            </button>
          </div>
        </section>
        
        <!-- 订阅区域 -->
        <section class="bg-orange-light py-12 mt-12">
          <div class="container mx-auto px-4 text-center">
            <h2 class="text-2xl font-bold mb-3">订阅我的博客更新</h2>
            <p class="text-neutral-700 mb-6 max-w-md mx-auto">第一时间获取最新文章和独家内容，不会发送垃圾邮件</p>
            <div class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto">
              <input type="email" placeholder="输入你的邮箱地址" class="flex-1 px-4 py-3 rounded-full focus:outline-none focus:ring-2 focus:ring-orange">
              <button class="bg-orange hover:bg-orange-dark text-white px-6 py-3 rounded-full font-medium transition-colors">
                订阅 <i class="fa fa-paper-plane ml-1" aria-hidden="true"></i>
              </button>
            </div>
          </div>
        </section>
      </div>
      
      <!-- 文章阅读页面 -->
      <div id="articlePage" class="page-content hidden py-12">
        <div class="container mx-auto px-4 max-w-4xl">
          <!-- 返回按钮 -->
          <div class="mb-8">
            <a href="#" class="inline-flex items-center text-neutral-600 hover:text-orange transition-colors back-to-list" data-page="home">
              <i class="fa fa-arrow-left mr-2" aria-hidden="true"></i> 返回文章列表
            </a>
          </div>
          
          <!-- 文章内容 -->
          <article class="bg-white rounded-xl shadow-md overflow-hidden">
            <!-- 文章封面 -->
            <div class="w-full h-64 md:h-80 overflow-hidden">
              <img id="articleReadCover" src="" alt="文章封面" class="w-full h-full object-cover">
            </div>
            
            <!-- 文章标题和元数据 -->
            <div class="p-6 md:p-8">
              <div class="flex items-center gap-2 text-sm text-neutral-600 mb-4 flex-wrap">
                <span id="articleReadCategory" class="bg-orange-light text-orange px-2 py-1 rounded-full"></span>
                <span id="articleReadDate"><i class="fa fa-calendar-o mr-1" aria-hidden="true"></i></span>
                <span id="articleReadTime"><i class="fa fa-clock-o mr-1" aria-hidden="true"></i></span>
              </div>
              
              <h1 id="articleReadTitle" class="text-3xl md:text-4xl font-bold mb-6"></h1>
              
              <div id="articleReadContent" class="markdown-preview text-lg text-neutral-800"></div>
              
              <!-- 文章操作按钮 -->
              <div class="mt-12 pt-6 border-t border-neutral-200 flex flex-wrap gap-4 justify-between items-center">
                <div class="flex gap-4">
                  <button class="text-neutral-600 hover:text-orange transition-colors flex items-center gap-1 edit-article" data-id="">
                    <i class="fa fa-pencil" aria-hidden="true"></i> 编辑
                  </button>
                  <button class="text-neutral-600 hover:text-red-500 transition-colors flex items-center gap-1 delete-article" data-id="">
                    <i class="fa fa-trash" aria-hidden="true"></i> 删除
                  </button>
                </div>
                
                <div class="flex gap-4">
                  <button class="text-neutral-600 hover:text-orange transition-colors flex items-center gap-1">
                    <i class="fa fa-share-alt" aria-hidden="true"></i> 分享
                  </button>
                  <button class="text-neutral-600 hover:text-orange transition-colors flex items-center gap-1">
                    <i class="fa fa-heart-o" aria-hidden="true"></i> 喜欢
                  </button>
                </div>
              </div>
            </div>
          </article>
          
          <!-- 上下篇导航 -->
          <div class="mt-10 grid grid-cols-1 md:grid-cols-2 gap-6">
            <div id="prevArticleContainer" class="bg-white rounded-xl shadow-md p-4 md:p-6 hidden">
              <p class="text-sm text-neutral-600 mb-2">上一篇</p>
              <a href="#" class="text-lg font-medium hover:text-orange transition-colors prev-article-link" data-id="">
                <i class="fa fa-angle-left mr-1" aria-hidden="true"></i>
                <span id="prevArticleTitle"></span>
              </a>
            </div>
            
            <div id="nextArticleContainer" class="bg-white rounded-xl shadow-md p-4 md:p-6 hidden md:text-right">
              <p class="text-sm text-neutral-600 mb-2">下一篇</p>
              <a href="#" class="text-lg font-medium hover:text-orange transition-colors next-article-link" data-id="">
                <span id="nextArticleTitle"></span>
                <i class="fa fa-angle-right ml-1" aria-hidden="true"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 写文章页面 -->
      <div id="writePage" class="page-content hidden py-12">
        <div class="container mx-auto px-4 max-w-4xl">
          <div class="flex items-center mb-8">
            <a href="#" class="text-neutral-600 hover:text-orange mr-4 transition-colors" data-page="home">
              <i class="fa fa-arrow-left" aria-hidden="true"></i> 返回首页
            </a>
            <h2 class="text-2xl font-bold">写文章</h2>
          </div>
          
          <form id="articleForm" class="bg-white rounded-xl shadow-md p-6 md:p-8">
            <input type="hidden" id="articleId"> <!-- 用于编辑现有文章 -->
            
            <div class="mb-6">
              <label for="articleTitle" class="block text-neutral-700 font-medium mb-2">标题</label>
              <input type="text" id="articleTitle" name="title" 
                     class="w-full px-4 py-3 rounded-lg border border-neutral-300 focus:outline-none focus:ring-2 focus:ring-orange focus:border-transparent"
                     placeholder="输入文章标题..." required>
            </div>
            
            <div class="mb-6">
              <label for="articleCategory" class="block text-neutral-700 font-medium mb-2">分类</label>
              <select id="articleCategory" name="category" 
                      class="w-full px-4 py-3 rounded-lg border border-neutral-300 focus:outline-none focus:ring-2 focus:ring-orange focus:border-transparent"
                      required>
                <option value="">选择分类</option>
                <option value="技术">技术</option>
                <option value="生活">生活</option>
                <option value="思考">思考</option>
                <option value="旅行">旅行</option>
                <option value="阅读">阅读</option>
              </select>
            </div>
            
            <div class="mb-6">
              <label for="articleCover" class="block text-neutral-700 font-medium mb-2">封面图URL</label>
              <input type="url" id="articleCover" name="cover" 
                     class="w-full px-4 py-3 rounded-lg border border-neutral-300 focus:outline-none focus:ring-2 focus:ring-orange focus:border-transparent"
                     placeholder="输入图片URL...">
              <p class="text-sm text-neutral-500 mt-1">建议尺寸：600x400px，支持网络图片URL（如https://picsum.photos/600/400）</p>
            </div>
            
            <!-- 编辑模式切换 -->
            <div class="mb-4">
              <div class="edit-mode-tabs flex border-b border-neutral-300">
                <button type="button" id="markdownModeBtn" class="px-4 py-2 font-medium active">
                  <i class="fa fa-markdown mr-1" aria-hidden="true"></i> Markdown编辑
                </button>
                <button type="button" id="previewModeBtn" class="px-4 py-2 font-medium text-neutral-600">
                  <i class="fa fa-eye mr-1" aria-hidden="true"></i> 预览
                </button>
                <button type="button" id="splitModeBtn" class="px-4 py-2 font-medium text-neutral-600">
                  <i class="fa fa-columns mr-1" aria-hidden="true"></i> 分屏编辑
                </button>
              </div>
            </div>
            
            <!-- 编辑器工具栏 -->
            <div class="editor-toolbar flex flex-wrap gap-2 p-3 bg-neutral-100 rounded-t-lg border border-b-0 border-neutral-300">
              <button type="button" data-action="heading1" title="标题1 (# 标题)">
                <i class="fa fa-header" aria-hidden="true"></i> <sub>1</sub>
              </button>
              <button type="button" data-action="heading2" title="标题2 (## 标题)">
                <i class="fa fa-header" aria-hidden="true"></i> <sub>2</sub>
              </button>
              <button type="button" data-action="heading3" title="标题3 (### 标题)">
                <i class="fa fa-header" aria-hidden="true"></i> <sub>3</sub>
              </button>
              <span class="h-6 border-r border-neutral-300"></span>
              <button type="button" data-action="bold" title="加粗 (**粗体**)">
                <i class="fa fa-bold" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="italic" title="斜体 (*斜体*)">
                <i class="fa fa-italic" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="strikethrough" title="删除线 (~~删除线~~)">
                <i class="fa fa-strikethrough" aria-hidden="true"></i>
              </button>
              <span class="h-6 border-r border-neutral-300"></span>
              <button type="button" data-action="link" title="链接 ([文本](链接))">
                <i class="fa fa-link" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="image" title="图片 (![描述](链接))">
                <i class="fa fa-image" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="code" title="代码 (`代码`)">
                <i class="fa fa-code" aria-hidden="true"></i>
              </button>
              <span class="h-6 border-r border-neutral-300"></span>
              <button type="button" data-action="quote" title="引用 (> 引用)">
                <i class="fa fa-quote-right" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="unordered-list" title="无序列表 (- 列表项)">
                <i class="fa fa-list-ul" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="ordered-list" title="有序列表 (1. 列表项)">
                <i class="fa fa-list-ol" aria-hidden="true"></i>
              </button>
              <span class="h-6 border-r border-neutral-300"></span>
              <button type="button" data-action="latex" title="LaTeX公式 ($公式$ 或 $$块公式$$)">
                <i class="fa fa-superscript" aria-hidden="true"></i> TeX
              </button>
              <button type="button" data-action="table" title="表格">
                <i class="fa fa-table" aria-hidden="true"></i>
              </button>
              <button type="button" data-action="hr" title="分割线 (---)">
                <i class="fa fa-minus" aria-hidden="true"></i>
              </button>
            </div>
            
            <!-- 编辑器容器 -->
            <div class="border border-neutral-300 rounded-b-lg overflow-hidden">
              <!-- Markdown编辑区 -->
              <div id="markdownEditor" class="w-full min-h-[400px] p-4 bg-white">
                <textarea id="articleContent" class="markdown-editor w-full h-full min-h-[400px] p-2 focus:outline-none resize-none" 
                          placeholder="使用Markdown编写文章内容...
示例：
# 这是一级标题
**粗体文本** *斜体文本*
- 无序列表项1
- 无序列表项2
LaTeX公式：$E=mc^2$ 或 $$\sum_{i=1}^n i = \frac{n(n+1)}{2}$$
"></textarea>
              </div>
              
              <!-- 预览区 -->
              <div id="previewArea" class="w-full min-h-[400px] p-4 bg-neutral-50 hidden markdown-preview"></div>
              
              <!-- 分屏编辑区 -->
              <div id="splitEditor" class="hidden">
                <div class="flex h-[400px]">
                  <div class="w-1/2 border-r border-neutral-300">
                    <textarea id="splitArticleContent" class="markdown-editor w-full h-full p-4 focus:outline-none resize-none" 
                              placeholder="使用Markdown编写文章内容..."></textarea>
                  </div>
                  <div id="splitPreviewArea" class="w-1/2 p-4 overflow-y-auto markdown-preview"></div>
                </div>
              </div>
            </div>
            
            <div class="flex justify-end gap-4 mt-6">
              <button type="button" id="cancelEditBtn" class="px-6 py-3 bg-white border border-neutral-300 text-neutral-700 rounded-full font-medium hover:bg-neutral-100 transition-colors">
                取消
              </button>
              <button type="button" id="helpBtn" class="px-6 py-3 bg-white border border-neutral-300 text-neutral-700 rounded-full font-medium hover:bg-neutral-100 transition-colors">
                <i class="fa fa-question-circle mr-1" aria-hidden="true"></i> 格式帮助
              </button>
              <button type="submit" class="px-6 py-3 bg-orange hover:bg-orange-dark text-white rounded-full font-medium transition-colors">
                <span id="submitBtnText">发布文章</span> <i class="fa fa-paper-plane ml-1" aria-hidden="true"></i>
              </button>
            </div>
          </form>
        </div>
      </div>
      
      <!-- 格式帮助模态框 -->
      <div id="helpModal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center hidden fade-in">
        <div class="bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto m-4">
          <div class="p-6 border-b border-neutral-200 flex justify-between items-center">
            <h3 class="text-xl font-bold">Markdown格式帮助</h3>
            <button id="closeHelpBtn" class="text-neutral-500 hover:text-neutral-800 transition-colors">
              <i class="fa fa-times text-xl" aria-hidden="true"></i>
            </button>
          </div>
          <div class="p-6">
            <div class="mb-6">
              <h4 class="text-lg font-semibold mb-3">标题</h4>
              <div class="bg-neutral-50 p-3 rounded-md mb-2"><pre># 一级标题\n## 二级标题\n### 三级标题</pre></div>
              <div class="markdown-preview"><h1>一级标题</h1><h2>二级标题</h2><h3>三级标题</h3></div>
            </div>
            <div class="mb-6">
              <h4 class="text-lg font-semibold mb-3">LaTeX公式</h4>
              <div class="bg-neutral-50 p-3 rounded-md mb-2"><pre>内联公式: $E = mc^2$\n块级公式:$$\sum_{i=1}^n i = \frac{n(n+1)}{2}$$</pre></div>
              <div class="markdown-preview">
                <p>内联公式: $E = mc^2$</p>
                <p>块级公式:$$\sum_{i=1}^n i = \frac{n(n+1)}{2}$$</p>
              </div>
            </div>
            <!-- 其他格式帮助（标题/列表/链接等）省略，保持代码简洁 -->
          </div>
        </div>
      </div>
      
      <!-- 文章管理页面 -->
      <div id="managePage" class="page-content hidden py-12">
        <div class="container mx-auto px-4 max-w-5xl">
          <div class="flex items-center mb-8">
            <a href="#" class="text-neutral-600 hover:text-orange mr-4 transition-colors" data-page="home">
              <i class="fa fa-arrow-left" aria-hidden="true"></i> 返回首页
            </a>
            <h2 class="text-2xl font-bold">管理文章</h2>
          </div>
          
          <div class="bg-white rounded-xl shadow-md p-6 md:p-8">
            <!-- 管理工具栏 -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6 pb-4 border-b border-neutral-200">
              <div class="flex items-center gap-2">
                <button id="addNewArticleBtn" class="px-4 py-2 bg-orange hover:bg-orange-dark text-white rounded-lg font-medium transition-colors flex items-center gap-1">
                  <i class="fa fa-plus" aria-hidden="true"></i> 新建文章
                </button>
                <button id="batchDeleteBtn" class="px-4 py-2 bg-white border border-red-200 text-red-500 hover:bg-red-50 rounded-lg font-medium transition-colors flex items-center gap-1 hidden">
                  <i class="fa fa-trash" aria-hidden="true"></i> 批量删除
                </button>
              </div>
              
              <div class="flex flex-wrap gap-3 w-full md:w-auto">
                <div class="relative">
                  <input type="text" id="manageSearchInput" placeholder="搜索文章..." class="w-full md:w-64 px-4 py-2 pl-10 rounded-lg border border-neutral-300 focus:outline-none focus:ring-2 focus:ring-orange focus:border-transparent">
                  <i class="fa fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400" aria-hidden="true"></i>
                </div>
                
                <div class="flex items-center gap-2">
                  <label class="text-neutral-600 whitespace-nowrap">排序：</label>
                  <div class="flex flex-wrap gap-1">
                    <button class="sort-btn px-3 py-1 rounded bg-white border border-neutral-300 hover:border-orange text-sm transition-colors active" data-sort="newest">
                      最新 <i class="fa fa-chevron-down sort-icon ml-1 text-xs" aria-hidden="true"></i>
                    </button>
                    <button class="sort-btn px-3 py-1 rounded bg-white border border-neutral-300 hover:border-orange text-sm transition-colors" data-sort="oldest">
                      最早 <i class="fa fa-chevron-down sort-icon ml-1 text-xs" aria-hidden="true"></i>
                    </button>
                    <button class="sort-btn px-3 py-1 rounded bg-white border border-neutral-300 hover:border-orange text-sm transition-colors" data-sort="title-asc">
                      标题A-Z <i class="fa fa-chevron-down sort-icon ml-1 text-xs" aria-hidden="true"></i>
                    </button>
                    <button class="sort-btn px-3 py-1 rounded bg-white border border-neutral-300 hover:border-orange text-sm transition-colors" data-sort="title-desc">
                      标题Z-A <i class="fa fa-chevron-down sort-icon ml-1 text-xs" aria-hidden="true"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- 文章管理表格 -->
            <div class="overflow-x-auto">
              <table class="w-full manage-table">
                <thead>
                  <tr class="border-b-2 border-neutral-200">
                    <th class="text-left py-3 px-4 w-12">
                      <input type="checkbox" id="selectAllCheckbox" class="rounded text-orange focus:ring-orange">
                    </th>
                    <th class="text-left py-3 px-4">标题</th>
                    <th class="text-left py-3 px-4 hidden md:table-cell">分类</th>
                    <th class="text-left py-3 px-4 hidden sm:table-cell">发布日期</th>
                    <th class="text-right py-3 px-4">操作</th>
                  </tr>
                </thead>
                <tbody id="manageArticlesTable">
                  <tr id="noArticlesManage" class="text-center">
                    <td colspan="6" class="py-12 text-neutral-500">
                      <i class="fa fa-file-text-o text-4xl mb-2" aria-hidden="true"></i>
                      <p>没有文章可管理</p>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <!-- 分页 -->
            <div class="flex justify-between items-center mt-6 pt-4 border-t border-neutral-200">
              <div class="text-neutral-600 text-sm">
                显示 <span id="showingCount">0</span> 篇文章，共 <span id="totalCount">0</span> 篇
              </div>
              <div class="flex gap-2">
                <button id="prevPageBtn" class="px-3 py-1 rounded border border-neutral-300 text-neutral-600 hover:border-orange hover:text-orange disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                  <i class="fa fa-chevron-left" aria-hidden="true"></i> 上一页
                </button>
                <button id="nextPageBtn" class="px-3 py-1 rounded border border-neutral-300 text-neutral-600 hover:border-orange hover:text-orange disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                  下一页 <i class="fa fa-chevron-right" aria-hidden="true"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 删除确认模态框 -->
      <div id="deleteConfirmModal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center hidden fade-in">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full m-4 scale-in">
          <div class="p-6 border-b border-neutral-200">
            <h3 class="text-xl font-bold text-red-500">确认删除</h3>
          </div>
          <div class="p-6">
            <p class="mb-6">你确定要删除这篇文章吗？此操作无法撤销。</p>
            <div class="flex justify-end gap-3">
              <button id="cancelDeleteBtn" class="px-4 py-2 border border-neutral-300 rounded-lg text-neutral-700 hover:bg-neutral-100 transition-colors">
                取消
              </button>
              <button id="confirmDeleteBtn" class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors">
                确认删除
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 分类页面 -->
      <div id="categoriesPage" class="page-content hidden py-12">
        <div class="container mx-auto px-4">
          <div class="flex items-center mb-8">
            <a href="#" class="text-neutral-600 hover:text-orange mr-4 transition-colors" data-page="home">
              <i class="fa fa-arrow-left" aria-hidden="true"></i> 返回首页
            </a>
            <h2 class="text-2xl font-bold">文章分类</h2>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-white rounded-xl shadow-md p-6 text-center card-hover">
              <div class="w-16 h-16 bg-orange-light rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa fa-code text-2xl text-orange" aria-hidden="true"></i>
              </div>
              <h3 class="text-xl font-bold mb-2">技术</h3>
              <p class="text-neutral-600 mb-4">关于编程、开发工具和技术趋势的文章</p>
              <p class="text-orange font-medium"><span id="techCount">0</span> 篇文章</p>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-6 text-center card-hover">
              <div class="w-16 h-16 bg-orange-light rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa fa-coffee text-2xl text-orange" aria-hidden="true"></i>
              </div>
              <h3 class="text-xl font-bold mb-2">生活</h3>
              <p class="text-neutral-600 mb-4">记录日常生活、习惯养成和生活感悟</p>
              <p class="text-orange font-medium"><span id="lifeCount">0</span> 篇文章</p>
            </div>
            
            <div class="bg-white rounded-xl shadow-md p-6 text-center card-hover">
              <div class="w-16 h-16 bg-orange-light rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa fa-lightbulb-o text-2xl text-orange" aria-hidden="true"></i>
              </div>
              <h3 class="text-xl font-bold mb-2">思考</h3>
              <p class="text-neutral-600 mb-4">关于职业发展、学习方法的思考与总结</p>
              <p class="text-orange font-medium"><span id="thoughtCount">0</span> 篇文章</p>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 关于页面 -->
      <div id="aboutPage" class="page-content hidden py-12">
        <div class="container mx-auto px-4 max-w-3xl">
          <div class="flex items-center mb-8">
            <a href="#" class="text-neutral-600 hover:text-orange mr-4 transition-colors" data-page="home">
              <i class="fa fa-arrow-left" aria-hidden="true"></i> 返回首页
            </a>
            <h2 class="text-2xl font-bold">关于我</h2>
          </div>
          
          <div class="bg-white rounded-xl shadow-md p-8">
            <div class="flex flex-col md:flex-row gap-8">
              <div class="md:w-1/3">
                <div class="rounded-full overflow-hidden w-40 h-40 mx-auto md:mx-0 border-4 border-orange-light">
                  <img src="https://picsum.photos/400/400?random=10" alt="博主头像" class="w-full h-full object-cover">
                </div>
              </div>
              <div class="md:w-2/3">
                <h3 class="text-2xl font-bold mb-4">大柯</h3>
                <p class="text-neutral-600 mb-4">
                  热爱技术与生活的创作者，致力于分享有价值的思考和经验。擅长前端开发、数据可视化，喜欢用文字记录成长。
                </p>
                <p class="text-neutral-600 mb-4">
                  这个博客基于Tailwind CSS和GitHub API构建，支持Markdown编辑和LaTeX数学公式，特别适合分享技术文章和学术内容。希望通过文字与更多志同道合的朋友交流。
                </p>
                <div class="flex gap-4 mt-6">
                  <a href="#" class="text-neutral-600 hover:text-orange transition-colors text-xl">
                    <i class="fa fa-github" aria-hidden="true"></i>
                  </a>
                  <a href="#" class="text-neutral-600 hover:text-orange transition-colors text-xl">
                    <i class="fa fa-twitter" aria-hidden="true"></i>
                  </a>
                  <a href="#" class="text-neutral-600 hover:text-orange transition-colors text-xl">
                    <i class="fa fa-linkedin" aria-hidden="true"></i>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- 页脚 -->
  <footer class="bg-neutral-800 text-white py-12">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
        <div>
          <h3 class="text-xl font-bold mb-4 text-orange">大柯的blog</h3>
          <p class="text-neutral-400 mb-4">支持Markdown和LaTeX的个人博客，分享技术、生活与思考，记录成长的点滴。</p>
          <div class="flex gap-4">
            <a href="#" class="text-neutral-400 hover:text-orange transition-colors text-lg">
              <i class="fa fa-github" aria-hidden="true"></i>
            </a>
            <a href="#" class="text-neutral-400 hover:text-orange transition-colors text-lg">
              <i class="fa fa-twitter" aria-hidden="true"></i>
            </a>
            <a href="#" class="text-neutral-400 hover:text-orange transition-colors text-lg">
              <i class="fa fa-linkedin" aria-hidden="true"></i>
            </a>
          </div>
        </div>
        
        <div>
          <h4 class="text-lg font-semibold mb-4">快速链接</h4>
          <ul class="space-y-2">
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors" data-page="home">首页</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors" data-page="categories">所有文章</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors" data-page="manage">管理文章</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors" data-page="about">关于我</a></li>
          </ul>
        </div>
        
        <div>
          <h4 class="text-lg font-semibold mb-4">分类</h4>
          <ul class="space-y-2">
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors">技术</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors">生活</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors">思考</a></li>
            <li><a href="#" class="text-neutral-400 hover:text-orange transition-colors">旅行</a></li>
          </ul>
        </div>
      </div>
      
      <div class="border-t border-neutral-700 pt-8 text-center text-neutral-500 text-sm">
        <p>&copy; 2024 大柯的blog. 基于GitHub API构建。</p>
      </div>
    </div>
  </footer>

  <!-- 返回顶部按钮 -->
  <button id="backToTop" class="fixed bottom-6 right-6 bg-orange hover:bg-orange-dark text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg transition-all duration-300 opacity-0 invisible">
    <i class="fa fa-arrow-up" aria-hidden="true"></i>
  </button>

  <!-- 通知提示 -->
  <div id="notification" class="fixed top-6 right-6 bg-white shadow-lg rounded-lg p-4 max-w-xs transform translate-x-[calc(100%+20px)] transition-transform duration-300 z-50 flex items-start gap-3">
    <div id="notificationIcon" class="text-green-500 mt-0.5">
      <i class="fa fa-check-circle text-xl" aria-hidden="true"></i>
    </div>
    <div>
      <h4 id="notificationTitle" class="font-semibold text-neutral-800">成功</h4>
      <p id="notificationMessage" class="text-neutral-600 text-sm">操作已完成</p>
    </div>
    <button id="closeNotification" class="text-neutral-400 hover:text-neutral-600 ml-auto">
      <i class="fa fa-times" aria-hidden="true"></i>
    </button>
  </div>

  <!-- JavaScript核心逻辑 -->
  <script>
    // ======================== 1. GitHub API 配置（必须替换为你的信息！）========================
    const GITHUB_CONFIG = {
      owner: "你的GitHub用户名",    // 例："张三" → "zhangsan"
      repo: "你的仓库名",          // 例："my-blog-data"
      path: "passage.json",        // 文章数据文件路径（固定，无需修改）
      branch: "main",              // 仓库分支（默认main，旧仓库可能是master）
      token: "你的个人访问令牌PAT"  // 例："ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
    };

    // ======================== 2. 全局变量 =========================
    let allArticles = [];          // 存储所有文章
    let currentSort = 'newest';    // 默认排序：最新
    let currentPage = 1;           // 分页页码
    const articlesPerPage = 10;    // 每页文章数
    let selectedArticleIds = [];   // 批量删除选中的文章ID
    let articleToDelete = null;    // 待删除的文章ID
    let currentArticleId = null;   // 当前阅读的文章ID
    let currentEditMode = 'markdown'; // 编辑模式：markdown/preview/split
    let isApiLoading = false;      // API请求加载状态
    window.articleFileSha = '';    // 文章文件的SHA值（GitHub更新必需）

    // ======================== 3. 页面初始化 =========================
    document.addEventListener('DOMContentLoaded', function() {
      // 从GitHub加载文章（核心入口）
      loadArticlesFromGitHub();
      // 初始化事件监听
      initEventListeners();
      // 初始化LaTeX渲染
      renderMathInElement(document.body, {
        delimiters: [
          {left: '$$', right: '$$', display: true},
          {left: '$', right: '$', display: false}
        ]
      });
    });

    // ======================== 4. GitHub API 核心函数 =========================
    /**
     * 从GitHub读取文章数据
     */
    async function loadArticlesFromGitHub() {
      if (isApiLoading) return;
      isApiLoading = true;
      showNotification('加载中', '正在从GitHub加载文章...', false);

      try {
        // 1. 请求GitHub获取文件信息（含SHA值）
        const fileRes = await fetch(
          `https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/contents/${GITHUB_CONFIG.path}?ref=${GITHUB_CONFIG.branch}`,
          {
            headers: {
              Authorization: `token ${GITHUB_CONFIG.token}`,
              Accept: "application/vnd.github.v3+json"
            }
          }
        );

        // 2. 处理文件不存在（首次使用时创建空文件）
        if (fileRes.status === 404) {
          await createEmptyArticleFile();
          allArticles = [];
        } else if (!fileRes.ok) {
          throw new Error(`请求失败：${fileRes.statusText}`);
        } else {
          // 3. 解析文件内容（GitHub返回base64编码）
          const fileData = await fileRes.json();
          const decodedContent = atob(fileData.content); // base64解码
          allArticles = JSON.parse(decodedContent) || [];
          window.articleFileSha = fileData.sha; // 保存SHA值（更新必需）
        }

        // 4. 加载完成后更新页面
        loadArticles();
        loadManageArticles();
        updateCategoryCounts();
        hideNotification();

      } catch (error) {
        console.error('GitHub读取失败：', error);
        showNotification('错误', `加载失败：${error.message}`, true);
      } finally {
        isApiLoading = false;
      }
    }

    /**
     * 首次使用：创建空的passage.json文件
     */
    async function createEmptyArticleFile() {
      const emptyContent = JSON.stringify([], null, 2); // 空数组（格式化JSON）
      const encodedContent = btoa(emptyContent); // 转为base64

      await fetch(
        `https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/contents/${GITHUB_CONFIG.path}`,
        {
          method: "PUT",
          headers: {
            Authorization: `token ${GITHUB_CONFIG.token}`,
            Accept: "application/vnd.github.v3+json"
          },
          body: JSON.stringify({
            message: "初始化文章数据文件",
            content: encodedContent,
            branch: GITHUB_CONFIG.branch
          })
        }
      );
    }

    /**
     * 保存文章到GitHub（新增/更新）
     * @param {Object} article - 文章对象
     */
    async function saveArticleToGitHub(article) {
      if (isApiLoading) return;
      isApiLoading = true;
      const isUpdate = !!article.id;
      showNotification('处理中', isUpdate ? '更新文章中...' : '发布文章中...', false);

      try {
        // 1. 准备更新后的文章数组
        let updatedArticles = [...allArticles];
        if (isUpdate) {
          // 更新现有文章
          updatedArticles = updatedArticles.map(a => a.id === article.id ? article : a);
        } else {
          // 新增文章：生成ID、日期、阅读时间
          article.id = Date.now();
          article.date = new Date().toISOString().split('T')[0];
          const wordCount = article.content.replace(/[#*`\[\](){}]/g, '').length;
          article.readTime = Math.ceil(wordCount / 200) || 1;
          updatedArticles.unshift(article); // 最新文章排前面
        }

        // 2. 转为JSON并base64编码（GitHub要求）
        const jsonContent = JSON.stringify(updatedArticles, null, 2);
        const encodedContent = btoa(jsonContent);

        // 3. 调用GitHub API更新文件
        const res = await fetch(
          `https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/contents/${GITHUB_CONFIG.path}`,
          {
            method: "PUT",
            headers: {
              Authorization: `token ${GITHUB_CONFIG.token}`,
              Accept: "application/vnd.github.v3+json"
            },
            body: JSON.stringify({
              message: isUpdate ? `更新文章：${article.title}` : `新增文章：${article.title}`,
              content: encodedContent,
              branch: GITHUB_CONFIG.branch,
              sha: window.articleFileSha // 必需：确保文件版本一致
            })
          }
        );

        if (!res.ok) {
          const errorData = await res.json();
          throw new Error(errorData.message || '保存失败');
        }

        // 4. 更新本地数据和页面
        allArticles = updatedArticles;
        loadArticles();
        loadManageArticles(document.getElementById('manageSearchInput').value);
        updateCategoryCounts();
        hideNotification();
        showNotification('成功', isUpdate ? '文章已更新' : '文章已发布');

        return article;

      } catch (error) {
        console.error('GitHub保存失败：', error);
        showNotification('错误', `保存失败：${error.message}`, true);
      } finally {
        isApiLoading = false;
      }
    }

    /**
     * 从GitHub删除文章（单篇/批量）
     * @param {Array<number>} articleIds - 待删除文章ID数组
     */
    async function deleteArticlesFromGitHub(articleIds) {
      if (isApiLoading || articleIds.length === 0) return;
      isApiLoading = true;
      const count = articleIds.length;
      showNotification('处理中', `正在删除 ${count} 篇文章...`, false);

      try {
        // 1. 过滤掉待删除的文章
        const updatedArticles = allArticles.filter(a => !articleIds.includes(a.id));

        // 2. 转为JSON并base64编码
        const jsonContent = JSON.stringify(updatedArticles, null, 2);
        const encodedContent = btoa(jsonContent);

        // 3. 调用GitHub API更新文件
        const res = await fetch(
          `https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/contents/${GITHUB_CONFIG.path}`,
          {
            method: "PUT",
            headers: {
              Authorization: `token ${GITHUB_CONFIG.token}`,
              Accept: "application/vnd.github.v3+json"
            },
            body: JSON.stringify({
              message: `删除 ${count} 篇文章`,
              content: encodedContent,
              branch: GITHUB_CONFIG.branch,
              sha: window.articleFileSha
            })
          }
        );

        if (!res.ok) {
          const errorData = await res.json();
          throw new Error(errorData.message || '删除失败');
        }

        // 4. 更新本地数据和页面
        allArticles = updatedArticles;
        loadArticles();
        loadManageArticles(document.getElementById('manageSearchInput').value);
        updateCategoryCounts();
        hideNotification();
        showNotification('成功', `已删除 ${count} 篇文章`);

      } catch (error) {
        console.error('GitHub删除失败：', error);
        showNotification('错误', `删除失败：${error.message}`, true);
      } finally {
        isApiLoading = false;
      }
    }

    // ======================== 5. 页面渲染与交互函数 =========================
    /**
     * 加载首页文章列表
     */
    function loadArticles(category = 'all') {
      const articlesGrid = document.getElementById('articlesGrid');
      const noArticles = document.getElementById('noArticles');

      // 清空现有内容
      Array.from(articlesGrid.children).forEach(child => {
        if (child.id !== 'noArticles') child.remove();
      });

      // 过滤分类
      let filtered = allArticles;
      if (category !== 'all') filtered = filtered.filter(a => a.category === category);

      if (filtered.length === 0) {
        noArticles.classList.remove('hidden');
        return;
      }
      noArticles.classList.add('hidden');

      // 渲染文章卡片
      filtered.forEach((article, index) => {
        setTimeout(() => {
          const card = createArticleCard(article);
          card.classList.add('fade-in', 'slide-up');
          articlesGrid.appendChild(card);
        }, index * 100);
      });
    }

    /**
     * 创建文章卡片
     */
    function createArticleCard(article) {
      const card = document.createElement('article');
      card.className = 'bg-white rounded-xl overflow-hidden shadow-md hover:shadow-xl card-hover';
      const defaultCover = `https://picsum.photos/600/400?random=${article.id % 10}`;

      // 处理摘要（移除Markdown/LaTeX标记）
      let summary = article.content
        .replace(/#{1,6}\s+/g, '')
        .replace(/\*\*|__|\*|_/g, '')
        .replace(/`[^`]+`|\$\$[^$]+\$\$|\$[^$]+\$/g, '')
        .substring(0, 150);

      card.innerHTML = `
        <div class="h-48 overflow-hidden">
          <img src="${article.cover || defaultCover}" alt="${article.title}" 
               class="w-full h-full object-cover transition-transform duration-500 hover:scale-110 opacity-0 transition-opacity duration-500">
        </div>
        <div class="p-6">
          <div class="flex items-center gap-2 text-sm text-neutral-600 mb-3">
            <span class="bg-orange-light text-orange px-2 py-1 rounded-full">${article.category}</span>
            <span><i class="fa fa-calendar-o mr-1"></i> ${article.date}</span>
            <span><i class="fa fa-clock-o mr-1"></i> ${article.readTime}分钟</span>
          </div>
          <h3 class="text-xl font-bold mb-3 hover:text-orange transition-colors">
            <a href="#" class="read-article" data-id="${article.id}">${article.title}</a>
          </h3>
          <p class="text-neutral-600 mb-4 line-clamp-3">${summary}...</p>
          <div class="flex justify-between items-center">
            <a href="#" class="text-orange font-medium hover:underline read-article" data-id="${article.id}">
              阅读全文 <i class="fa fa-long-arrow-right ml-2"></i>
            </a>
            <div class="flex gap-2">
              <button class="text-neutral-400 hover:text-orange edit-article" data-id="${article.id}">
                <i class="fa fa-pencil"></i>
              </button>
              <button class="text-neutral-400 hover:text-red-500 delete-article" data-id="${article.id}">
                <i class="fa fa-trash"></i>
              </button>
            </div>
          </div>
        </div>
      `;

      // 图片加载完成后显示
      const img = card.querySelector('img');
      img.onload = () => img.classList.add('opacity-100');
      if (img.complete) img.classList.add('opacity-100');

      return card;
    }

    /**
     * 加载文章阅读页
     */
    function loadArticleForReading(articleId) {
      const article = allArticles.find(a => a.id === articleId);
      if (!article) {
        showNotification('错误', '文章不存在', true);
        return;
      }

      // 填充内容
      document.getElementById('articleReadTitle').textContent = article.title;
      document.getElementById('articleReadCategory').textContent = article.category;
      document.getElementById('articleReadDate').innerHTML = `<i class="fa fa-calendar-o mr-1"></i> ${article.date}`;
      document.getElementById('articleReadTime').innerHTML = `<i class="fa fa-clock-o mr-1"></i> ${article.readTime}分钟阅读`;
      
      // 渲染Markdown+LaTeX
      const contentEl = document.getElementById('articleReadContent');
      contentEl.innerHTML = marked.parse(article.content);
      renderMathInElement(contentEl, {
        delimiters: [{left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}]
      });

      // 封面图
      const coverEl = document.getElementById('articleReadCover');
      const defaultCover = `https://picsum.photos/600/400?random=${article.id % 10}`;
      coverEl.src = article.cover || defaultCover;
      coverEl.alt = article.title;

      // 设置操作按钮ID
      document.querySelector('.edit-article[data-id=""]').setAttribute('data-id', article.id);
      document.querySelector('.delete-article[data-id=""]').setAttribute('data-id', article.id);

      // 更新上下篇导航
      updateArticleNavigation(articleId);

      // 切换页面
      document.querySelectorAll('.page-content').forEach(page => page.classList.add('hidden'));
      document.getElementById('articlePage').classList.remove('hidden');
      window.scrollTo({top: 0, behavior: 'smooth'});
    }

    /**
     * 更新上下篇导航
     */
    function updateArticleNavigation(currentId) {
      const sorted = [...allArticles].sort((a, b) => new Date(b.date) - new Date(a.date));
      const currentIdx = sorted.findIndex(a => a.id === currentId);

      // 上一篇
      const prevEl = document.getElementById('prevArticleContainer');
      const prevTitleEl = document.getElementById('prevArticleTitle');
      const prevLinkEl = document.querySelector('.prev-article-link');
      if (currentIdx < sorted.length - 1) {
        const prev = sorted[currentIdx + 1];
        prevTitleEl.textContent = prev.title;
        prevLinkEl.setAttribute('data-id', prev.id);
        prevEl.classList.remove('hidden');
      } else {
        prevEl.classList.add('hidden');
      }

      // 下一篇
      const nextEl = document.getElementById('nextArticleContainer');
      const nextTitleEl = document.getElementById('nextArticleTitle');
      const nextLinkEl = document.querySelector('.next-article-link');
      if (currentIdx > 0) {
        const next = sorted[currentIdx - 1];
        nextTitleEl.textContent = next.title;
        nextLinkEl.setAttribute('data-id', next.id);
        nextEl.classList.remove('hidden');
      } else {
        nextEl.classList.add('hidden');
      }
    }

    /**
     * 加载管理页文章表格
     */
    function loadManageArticles(searchQuery = '') {
      const tableBody = document.getElementById('manageArticlesTable');
      const noArticlesEl = document.getElementById('noArticlesManage');

      // 清空内容
      Array.from(tableBody.children).forEach(child => {
        if (child.id !== 'noArticlesManage') child.remove();
      });

      // 搜索过滤
      let filtered = allArticles;
      if (searchQuery) {
        const query = searchQuery.toLowerCase();
        filtered = filtered.filter(a => 
          a.title.toLowerCase().includes(query) || 
          a.category.toLowerCase().includes(query)
        );
      }

      // 排序
      filtered = sortArticles(filtered, currentSort);

      // 分页处理
      const total = filtered.length;
      const totalPages = Math.ceil(total / articlesPerPage);
      const start = (currentPage - 1) * articlesPerPage;
      const paginated = filtered.slice(start, start + articlesPerPage);

      // 更新分页信息
      document.getElementById('showingCount').textContent = paginated.length;
      document.getElementById('totalCount').textContent = total;
      document.getElementById('prevPageBtn').disabled = currentPage === 1;
      document.getElementById('nextPageBtn').disabled = currentPage === totalPages || total === 0;

      if (total === 0) {
        noArticlesEl.classList.remove('hidden');
        document.getElementById('batchDeleteBtn').classList.add('hidden');
        return;
      }
      noArticlesEl.classList.add('hidden');
      document.getElementById('batchDeleteBtn').classList.remove('hidden');

      // 渲染表格行
      paginated.forEach(article => {
        const row = document.createElement('tr');
        row.className = 'border-b border-neutral-200';
        row.innerHTML = `
          <td class="py-3 px-4">
            <input type="checkbox" class="article-checkbox rounded text-orange focus:ring-orange" data-id="${article.id}">
          </td>
          <td class="py-3 px-4">
            <div class="font-medium hover:text-orange transition-colors read-article" data-id="${article.id}">${article
